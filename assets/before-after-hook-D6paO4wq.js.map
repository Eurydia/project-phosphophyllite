{"version":3,"file":"before-after-hook-D6paO4wq.js","sources":["../../node_modules/before-after-hook/lib/register.js","../../node_modules/before-after-hook/lib/add.js","../../node_modules/before-after-hook/lib/remove.js","../../node_modules/before-after-hook/index.js"],"sourcesContent":["module.exports = register;\n\nfunction register(state, name, method, options) {\n  if (typeof method !== \"function\") {\n    throw new Error(\"method for before hook must be a function\");\n  }\n\n  if (!options) {\n    options = {};\n  }\n\n  if (Array.isArray(name)) {\n    return name.reverse().reduce(function (callback, name) {\n      return register.bind(null, state, name, callback, options);\n    }, method)();\n  }\n\n  return Promise.resolve().then(function () {\n    if (!state.registry[name]) {\n      return method(options);\n    }\n\n    return state.registry[name].reduce(function (method, registered) {\n      return registered.hook.bind(null, method, options);\n    }, method)();\n  });\n}\n","module.exports = addHook;\n\nfunction addHook(state, kind, name, hook) {\n  var orig = hook;\n  if (!state.registry[name]) {\n    state.registry[name] = [];\n  }\n\n  if (kind === \"before\") {\n    hook = function (method, options) {\n      return Promise.resolve()\n        .then(orig.bind(null, options))\n        .then(method.bind(null, options));\n    };\n  }\n\n  if (kind === \"after\") {\n    hook = function (method, options) {\n      var result;\n      return Promise.resolve()\n        .then(method.bind(null, options))\n        .then(function (result_) {\n          result = result_;\n          return orig(result, options);\n        })\n        .then(function () {\n          return result;\n        });\n    };\n  }\n\n  if (kind === \"error\") {\n    hook = function (method, options) {\n      return Promise.resolve()\n        .then(method.bind(null, options))\n        .catch(function (error) {\n          return orig(error, options);\n        });\n    };\n  }\n\n  state.registry[name].push({\n    hook: hook,\n    orig: orig,\n  });\n}\n","module.exports = removeHook;\n\nfunction removeHook(state, name, method) {\n  if (!state.registry[name]) {\n    return;\n  }\n\n  var index = state.registry[name]\n    .map(function (registered) {\n      return registered.orig;\n    })\n    .indexOf(method);\n\n  if (index === -1) {\n    return;\n  }\n\n  state.registry[name].splice(index, 1);\n}\n","var register = require(\"./lib/register\");\nvar addHook = require(\"./lib/add\");\nvar removeHook = require(\"./lib/remove\");\n\n// bind with array of arguments: https://stackoverflow.com/a/21792913\nvar bind = Function.bind;\nvar bindable = bind.bind(bind);\n\nfunction bindApi(hook, state, name) {\n  var removeHookRef = bindable(removeHook, null).apply(\n    null,\n    name ? [state, name] : [state]\n  );\n  hook.api = { remove: removeHookRef };\n  hook.remove = removeHookRef;\n  [\"before\", \"error\", \"after\", \"wrap\"].forEach(function (kind) {\n    var args = name ? [state, kind, name] : [state, kind];\n    hook[kind] = hook.api[kind] = bindable(addHook, null).apply(null, args);\n  });\n}\n\nfunction HookSingular() {\n  var singularHookName = \"h\";\n  var singularHookState = {\n    registry: {},\n  };\n  var singularHook = register.bind(null, singularHookState, singularHookName);\n  bindApi(singularHook, singularHookState, singularHookName);\n  return singularHook;\n}\n\nfunction HookCollection() {\n  var state = {\n    registry: {},\n  };\n\n  var hook = register.bind(null, state);\n  bindApi(hook, state);\n\n  return hook;\n}\n\nvar collectionHookDeprecationMessageDisplayed = false;\nfunction Hook() {\n  if (!collectionHookDeprecationMessageDisplayed) {\n    console.warn(\n      '[before-after-hook]: \"Hook()\" repurposing warning, use \"Hook.Collection()\". Read more: https://git.io/upgrade-before-after-hook-to-1.4'\n    );\n    collectionHookDeprecationMessageDisplayed = true;\n  }\n  return HookCollection();\n}\n\nHook.Singular = HookSingular.bind();\nHook.Collection = HookCollection.bind();\n\nmodule.exports = Hook;\n// expose constructors as a named property for TypeScript\nmodule.exports.Hook = Hook;\nmodule.exports.Singular = Hook.Singular;\nmodule.exports.Collection = Hook.Collection;\n"],"names":["register_1","register","state","name","method","options","callback","registered","add","addHook","kind","hook","orig","result","result_","error","remove","removeHook","index","require$$0","require$$1","require$$2","bind","bindable","bindApi","removeHookRef","args","HookSingular","singularHookName","singularHookState","singularHook","HookCollection","collectionHookDeprecationMessageDisplayed","Hook","beforeAfterHookModule"],"mappings":"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","x_google_ignoreList":[0,1,2,3]}