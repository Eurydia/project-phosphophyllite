import{f as w}from"./hast-util-from-html-isomorphic-DWKUa-bN.js";import{k as d}from"./katex-RUdq65sM.js";import{v as S,S as k}from"./unist-util-visit-parents-CUezI4aM.js";import{t as C}from"./hast-util-to-text-CQFnfAl4.js";const I={},O=[];function E(f){const s=f||I;return function(g,y){S(g,"element",function(r,o){const n=Array.isArray(r.properties.className)?r.properties.className:O,p=n.includes("language-math"),m=n.includes("math-display"),x=n.includes("math-inline");let a=m;if(!p&&!m&&!x)return;let e=o[o.length-1],i=r;if(r.tagName==="code"&&p&&e&&e.type==="element"&&e.tagName==="pre"&&(i=e,e=o[o.length-2],a=!0),!e)return;const c=C(i,{whitespace:"pre"});let t;try{t=d.renderToString(c,{...s,displayMode:a,throwOnError:!0})}catch(l){const h=l,u=h.name.toLowerCase();y.message("Could not render math with KaTeX",{ancestors:[...o,r],cause:h,place:r.position,ruleId:u,source:"rehype-katex"}),u==="parseerror"?t=d.renderToString(c,{...s,displayMode:a,strict:"ignore",throwOnError:!1}):t=[{type:"element",tagName:"span",properties:{className:["katex-error"],style:"color:"+(s.errorColor||"#cc0000"),title:String(l)},children:[{type:"text",value:c}]}]}typeof t=="string"&&(t=w(t,{fragment:!0}).children);const N=e.children.indexOf(i);return e.children.splice(N,1,...t),k})}}export{E as r};
//# sourceMappingURL=rehype-katex-Dz5iAQV3.js.map
