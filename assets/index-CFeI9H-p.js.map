{"version":3,"file":"index-CFeI9H-p.js","sources":["../../src/constants/REPO_FILTER_OPTIONS.ts","../../src/core/sorting.ts","../../src/core/time.ts","../../src/constants/ISSUE_FILTER_OPTIONS.ts","../../src/database/preferences.ts","../../src/components/StyledDataTable.tsx","../../src/components/StyledSelect.tsx","../../src/components/StyledSelectMultiple.tsx","../../src/components/StyledTextField.tsx","../../src/components/RepoDataTable.tsx","../../src/components/StyledBreadcrumbs.tsx","../../src/database/migration.ts","../../src/database/api.ts","../../src/database/cached.ts","../../src/views/WithAppBar.tsx","../../src/pages/CollectionDetailsPage/CollectionDetailsPage.tsx","../../src/pages/CollectionDetailsPage/loader.ts","../../src/pages/CollectionListPage/CollectionListPage.tsx","../../src/pages/CollectionListPage/loader.ts","../../src/pages/ErrorBoundary.tsx","../../src/components/IssueDataTable.tsx","../../src/pages/HomePage/HomePage.tsx","../../src/pages/HomePage/loader.ts","../../src/core/markdown.ts","../../src/components/Markdown.tsx","../../src/pages/IssueDetailsPage/IssueDetailsPage.tsx","../../src/pages/IssueDetailsPage/loader.tsx","../../src/pages/IssueListPage/IssueListPage.tsx","../../src/core/filtering.ts","../../src/pages/IssueListPage/loader.ts","../../src/core/query.ts","../../src/pages/RepoDetailsPage/RepoDetailsPage.tsx","../../src/pages/RepoDetailsPage/loader.tsx","../../src/pages/RepoListPage/RepoListPage.tsx","../../src/pages/RepoListPage/loader.ts","../../src/pages/SettingsPage/SettingRegions/WrappableListItem.tsx","../../src/pages/SettingsPage/SettingRegions/SettingRegionAPI.tsx","../../src/pages/SettingsPage/SettingRegions/SettingRegionIssueFilterPref.tsx","../../src/pages/SettingsPage/SettingRegions/SettingRegionRepoFilterPref.tsx","../../src/pages/SettingsPage/SettingRegions/SettingRegionSync.tsx","../../src/pages/SettingsPage/SettingsPage.tsx","../../src/theme.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["import { GenericSelectOptions } from \"~types/generics\";\r\n\r\nexport const REPO_FILTER_PREF_TOPIC_MATCH_STRATEGY_KEY =\r\n\t\"repo-filter-pref-topic-match-strategy\";\r\nexport const REPO_FILTER_PREF_VISIBILITY_KEY =\r\n\t\"repo-filter-pref-visibility\";\r\nexport const REPO_FILTER_PREF_STATUS_KEY =\r\n\t\"repo-filter-pref-status\";\r\n\r\nexport const REPO_FILTER_TOPIC_MATCH_STRATEGY_OPTIONS: GenericSelectOptions<string>[] =\r\n\t[\r\n\t\t{\r\n\t\t\tlabel: \"Match all\",\r\n\t\t\tvalue: \"Match all\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Match any\",\r\n\t\t\tvalue: \"Match any\",\r\n\t\t},\r\n\t];\r\n\r\nexport const REPO_FILTER_VISIBILITY_OPTIONS: GenericSelectOptions<string>[] =\r\n\t[\r\n\t\t{\r\n\t\t\tlabel: \"All\",\r\n\t\t\tvalue: \"All\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Private\",\r\n\t\t\tvalue: \"Private\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Public\",\r\n\t\t\tvalue: \"Public\",\r\n\t\t},\r\n\t];\r\n\r\nexport const REPO_FILTER_STATUS_OPTIONS: GenericSelectOptions<string>[] =\r\n\t[\r\n\t\t{\r\n\t\t\tlabel: \"All\",\r\n\t\t\tvalue: \"All\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Active\",\r\n\t\t\tvalue: \"Active\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Archived\",\r\n\t\t\tvalue: \"Archived\",\r\n\t\t},\r\n\t];\r\n","export const orderByString = (\r\n\ta: string | null | undefined,\r\n\tb: string | null | undefined,\r\n): number => {\r\n\t// moves nullish values to the end\r\n\r\n\tconst a_ = a ?? false;\r\n\tconst b_ = b ?? false;\r\n\tif (!a_ && b_) {\r\n\t\treturn 1;\r\n\t}\r\n\tif (!a_ && !b_) {\r\n\t\treturn 0;\r\n\t}\r\n\tif (a_ && !b_) {\r\n\t\treturn -1;\r\n\t}\r\n\treturn b!.localeCompare(a!);\r\n};\r\n\r\nexport const orderByBoolean = (\r\n\ta: boolean | null | undefined,\r\n\tb: boolean | null | undefined,\r\n) => {\r\n\tconst a_ = Boolean(a);\r\n\tconst b_ = Boolean(b);\r\n\tif (a_ === b_) {\r\n\t\treturn 0;\r\n\t}\r\n\tif (a_ && !b_) {\r\n\t\treturn -1;\r\n\t}\r\n\treturn 1;\r\n};\r\n\r\nexport const orderByNumber = (\r\n\ta: number | null | undefined,\r\n\tb: number | null | undefined,\r\n) => {\r\n\tconst a_ = a ?? false;\r\n\tconst b_ = b ?? false;\r\n\tif (!a_ && b_) {\r\n\t\treturn 1;\r\n\t}\r\n\tif (!a_ && !b_) {\r\n\t\treturn 0;\r\n\t}\r\n\tif (a_ && !b_) {\r\n\t\treturn -1;\r\n\t}\r\n\r\n\treturn b! - a!;\r\n};\r\n","import moment from \"moment\";\r\n\r\nexport const timeSince = (\r\n\tdateString: string | undefined | null,\r\n\tfallback: string = \"-\",\r\n) => {\r\n\tif (\r\n\t\tdateString === undefined ||\r\n\t\tdateString === null ||\r\n\t\tdateString === \"\"\r\n\t) {\r\n\t\treturn fallback;\r\n\t}\r\n\r\n\treturn moment(dateString).fromNow();\r\n};\r\n\r\nexport const normalizeDateString = (\r\n\tdateString: string | undefined | null,\r\n\tfallback: string = \"-\",\r\n) => {\r\n\tif (\r\n\t\tdateString === undefined ||\r\n\t\tdateString === null ||\r\n\t\tdateString === \"\"\r\n\t) {\r\n\t\treturn fallback;\r\n\t}\r\n\r\n\treturn moment(dateString).format(\r\n\t\t\"MMMM Do YYYY\",\r\n\t);\r\n};\r\n\r\nexport const toTimeStamp = (\r\n\tdateString: string | null | undefined,\r\n\tfallback: string,\r\n) => {\r\n\tif (\r\n\t\tdateString === undefined ||\r\n\t\tdateString === null ||\r\n\t\tdateString === \"\"\r\n\t) {\r\n\t\treturn fallback;\r\n\t}\r\n\tconst timeAt = normalizeDateString(dateString);\r\n\tconst delta = timeSince(dateString);\r\n\treturn `${timeAt} (${delta})`;\r\n};\r\n","import { GenericSelectOptions } from \"~types/generics\";\r\n\r\nexport const ISSUE_FILTER_PREF_STATE_KEY =\r\n\t\"issue-filter-pref-state\";\r\n\r\nexport const ISSUE_FILTER_PREF_OWNER_TYPE_KEY =\r\n\t\"issue-filter-pref-owner-type\";\r\n\r\nexport const ISSUE_FILTER_STATE_OPTIONS: GenericSelectOptions<string>[] =\r\n\t[\r\n\t\t{\r\n\t\t\tlabel: \"All\",\r\n\t\t\tvalue: \"All\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Open\",\r\n\t\t\tvalue: \"open\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Closed\",\r\n\t\t\tvalue: \"closed\",\r\n\t\t},\r\n\t];\r\n\r\nexport const ISSUE_FILTER_OWNER_TYPE_OPTIONS: GenericSelectOptions<string>[] =\r\n\t[\r\n\t\t{\r\n\t\t\tlabel: \"All\",\r\n\t\t\tvalue: \"All\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Bot\",\r\n\t\t\tvalue: \"Bot\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"User\",\r\n\t\t\tvalue: \"User\",\r\n\t\t},\r\n\t];\r\n","import {\r\n\tISSUE_FILTER_PREF_OWNER_TYPE_KEY,\r\n\tISSUE_FILTER_PREF_STATE_KEY,\r\n\tREPO_FILTER_PREF_STATUS_KEY,\r\n\tREPO_FILTER_PREF_TOPIC_MATCH_STRATEGY_KEY,\r\n\tREPO_FILTER_PREF_VISIBILITY_KEY,\r\n} from \"~constants\";\r\n\r\n/////////////////////////////////////////////\r\n// Repo filter preferences\r\nexport const getRepoFilterPrefVisibility =\r\n\t(): string => {\r\n\t\tconst data = localStorage.getItem(\r\n\t\t\tREPO_FILTER_PREF_VISIBILITY_KEY,\r\n\t\t);\r\n\t\tif (data !== null) {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\treturn \"All\";\r\n\t};\r\nexport const setRepoFilterPrefVisibility = (\r\n\tvalue: string,\r\n) => {\r\n\tlocalStorage.setItem(\r\n\t\tREPO_FILTER_PREF_VISIBILITY_KEY,\r\n\t\tvalue,\r\n\t);\r\n};\r\nexport const getRepoFilterPrefStatus =\r\n\t(): string => {\r\n\t\tconst data = localStorage.getItem(\r\n\t\t\tREPO_FILTER_PREF_STATUS_KEY,\r\n\t\t);\r\n\t\tif (data !== null) {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\treturn \"All\";\r\n\t};\r\nexport const setRepoFilterPrefStatus = (\r\n\tvalue: string,\r\n) => {\r\n\tlocalStorage.setItem(\r\n\t\tREPO_FILTER_PREF_STATUS_KEY,\r\n\t\tvalue,\r\n\t);\r\n};\r\nexport const getRepoFilterPrefTopicMatchStrategy =\r\n\t() => {\r\n\t\tconst data = localStorage.getItem(\r\n\t\t\tREPO_FILTER_PREF_TOPIC_MATCH_STRATEGY_KEY,\r\n\t\t);\r\n\t\tif (data !== null) {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\treturn \"Match all\";\r\n\t};\r\nexport const setRepoFilterPrefTopicMatchStrategy =\r\n\t(value: string) => {\r\n\t\tlocalStorage.setItem(\r\n\t\t\tREPO_FILTER_PREF_TOPIC_MATCH_STRATEGY_KEY,\r\n\t\t\tvalue,\r\n\t\t);\r\n\t};\r\n/////////////////////////////////////////////\r\n// Issues filter preferences\r\nexport const getIssueFilterPrefState =\r\n\t(): string => {\r\n\t\tconst data = localStorage.getItem(\r\n\t\t\tISSUE_FILTER_PREF_STATE_KEY,\r\n\t\t);\r\n\t\tif (data !== null) {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\treturn \"All\";\r\n\t};\r\nexport const setIssueFilterPrefState = (\r\n\tvalue: string,\r\n) => {\r\n\tlocalStorage.setItem(\r\n\t\tISSUE_FILTER_PREF_STATE_KEY,\r\n\t\tvalue,\r\n\t);\r\n};\r\nexport const getIssueFilterPrefOwnerType =\r\n\t(): string => {\r\n\t\tconst data = localStorage.getItem(\r\n\t\t\t\"issue-filter-pref-owner-type\",\r\n\t\t);\r\n\t\tif (data !== null) {\r\n\t\t\treturn data;\r\n\t\t}\r\n\t\treturn \"User\";\r\n\t};\r\nexport const setIssueFilterPrefOwnerType = (\r\n\tvalue: string,\r\n) => {\r\n\tlocalStorage.setItem(\r\n\t\tISSUE_FILTER_PREF_OWNER_TYPE_KEY,\r\n\t\tvalue,\r\n\t);\r\n};\r\n","import {\r\n\tTable,\r\n\tTableBody,\r\n\tTableCell,\r\n\tTableContainer,\r\n\tTableHead,\r\n\tTableRow,\r\n\tTableSortLabel,\r\n} from \"@mui/material\";\r\nimport {\r\n\tMouseEvent,\r\n\tuseMemo,\r\n\tuseState,\r\n} from \"react\";\r\nimport { GenericDataCell } from \"~types/generics\";\r\n\r\ntype StyledTableHeadProps<T> = {\r\n\torder: \"asc\" | \"desc\";\r\n\torderBy: keyof T;\r\n\tonRequestSort: (value: keyof T) => void;\r\n\tcolumnDefinition: GenericDataCell<T>[];\r\n};\r\nconst StyledTableHead = <T,>(\r\n\tprops: StyledTableHeadProps<T>,\r\n) => {\r\n\tconst {\r\n\t\torder,\r\n\t\torderBy,\r\n\t\tonRequestSort,\r\n\t\tcolumnDefinition,\r\n\t} = props;\r\n\r\n\tconst createSortHandler =\r\n\t\t(property: keyof T) =>\r\n\t\t(_: MouseEvent<unknown>) => {\r\n\t\t\tonRequestSort(property);\r\n\t\t};\r\n\r\n\treturn (\r\n\t\t<TableHead>\r\n\t\t\t<TableRow>\r\n\t\t\t\t{columnDefinition.map(\r\n\t\t\t\t\t({ id, label }, index) => (\r\n\t\t\t\t\t\t<TableCell\r\n\t\t\t\t\t\t\tkey={`cell-${index}`}\r\n\t\t\t\t\t\t\tsortDirection={\r\n\t\t\t\t\t\t\t\torderBy === id ? order : undefined\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<TableSortLabel\r\n\t\t\t\t\t\t\t\tactive={orderBy === id}\r\n\t\t\t\t\t\t\t\tdirection={\r\n\t\t\t\t\t\t\t\t\torderBy === id ? order : \"asc\"\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tonClick={createSortHandler(id)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t</TableSortLabel>\r\n\t\t\t\t\t\t</TableCell>\r\n\t\t\t\t\t),\r\n\t\t\t\t)}\r\n\t\t\t</TableRow>\r\n\t\t</TableHead>\r\n\t);\r\n};\r\n\r\ntype StyledTableRowProps<T> = {\r\n\titem: T;\r\n\tcolumnDefinition: GenericDataCell<T>[];\r\n};\r\nconst StyledTableRow = <T,>(\r\n\tprops: StyledTableRowProps<T>,\r\n) => {\r\n\tconst { item, columnDefinition } = props;\r\n\r\n\treturn (\r\n\t\t<TableRow>\r\n\t\t\t{columnDefinition.map(\r\n\t\t\t\t({ render }, index) => (\r\n\t\t\t\t\t<TableCell key={`data-cell-${index}`}>\r\n\t\t\t\t\t\t{render(item)}\r\n\t\t\t\t\t</TableCell>\r\n\t\t\t\t),\r\n\t\t\t)}\r\n\t\t</TableRow>\r\n\t);\r\n};\r\n\r\ntype StyledDataTableProps<T> = {\r\n\titems: T[];\r\n\tcolumnDefinition: GenericDataCell<T>[];\r\n\tdefaultOrderBy: keyof T;\r\n\torderingFn: (\r\n\t\tproperty: keyof T,\r\n\t) => ((a: T, b: T) => number) | undefined;\r\n};\r\nexport const StyledDataTable = <T,>(\r\n\tprops: StyledDataTableProps<T>,\r\n) => {\r\n\tconst {\r\n\t\torderingFn,\r\n\t\titems,\r\n\t\tcolumnDefinition,\r\n\t\tdefaultOrderBy: orderBy,\r\n\t} = props;\r\n\r\n\tconst [order, setOrder] = useState<\r\n\t\t\"asc\" | \"desc\"\r\n\t>(\"desc\");\r\n\tconst [orderBy_, setOrderBy] =\r\n\t\tuseState(orderBy);\r\n\r\n\tconst handleRequestSort = (\r\n\t\tproperty: keyof T,\r\n\t) => {\r\n\t\tconst isAsc =\r\n\t\t\torderBy_ === property && order === \"asc\";\r\n\t\tsetOrder(isAsc ? \"desc\" : \"asc\");\r\n\t\tsetOrderBy(property);\r\n\t};\r\n\r\n\tconst items_ = useMemo(() => {\r\n\t\tconst orderFn:\r\n\t\t\t| ((a: T, b: T) => number)\r\n\t\t\t| undefined = orderingFn(orderBy_);\r\n\r\n\t\tif (orderFn === undefined) {\r\n\t\t\treturn items;\r\n\t\t}\r\n\t\tconst orderedItems_ = [...items];\r\n\t\torderedItems_.sort(orderFn);\r\n\t\tif (order === \"asc\") {\r\n\t\t\torderedItems_.reverse();\r\n\t\t}\r\n\t\treturn orderedItems_;\r\n\t}, [order, orderBy_, items]);\r\n\r\n\treturn (\r\n\t\t<TableContainer>\r\n\t\t\t<Table>\r\n\t\t\t\t<StyledTableHead\r\n\t\t\t\t\tcolumnDefinition={columnDefinition}\r\n\t\t\t\t\tonRequestSort={handleRequestSort}\r\n\t\t\t\t\torder={order}\r\n\t\t\t\t\torderBy={orderBy_}\r\n\t\t\t\t/>\r\n\t\t\t\t<TableBody>\r\n\t\t\t\t\t{items_.map((item, index) => (\r\n\t\t\t\t\t\t<StyledTableRow\r\n\t\t\t\t\t\t\tkey={`data-cell-item-${index}`}\r\n\t\t\t\t\t\t\titem={item}\r\n\t\t\t\t\t\t\tcolumnDefinition={columnDefinition}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</TableBody>\r\n\t\t\t</Table>\r\n\t\t</TableContainer>\r\n\t);\r\n};\r\n","import {\r\n\tMenuItem,\r\n\tSelect,\r\n\tSelectProps,\r\n} from \"@mui/material\";\r\nimport { FC } from \"react\";\r\n\r\ntype StyledSelectProps = SelectProps<string> & {\r\n\toptions?: { label: string; value: string }[];\r\n};\r\nexport const StyledSelect: FC<\r\n\tStyledSelectProps\r\n> = (props) => {\r\n\tconst { options, ...rest } = props;\r\n\tconst options_ = options ?? [];\r\n\treturn (\r\n\t\t<Select {...rest}>\r\n\t\t\t{options_.map(({ value, label }, index) => (\r\n\t\t\t\t<MenuItem\r\n\t\t\t\t\tdisableRipple\r\n\t\t\t\t\tkey={`${value}-${index}`}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t>\r\n\t\t\t\t\t{label}\r\n\t\t\t\t</MenuItem>\r\n\t\t\t))}\r\n\t\t</Select>\r\n\t);\r\n};\r\n","import {\r\n\tListSubheader,\r\n\tMenuItem,\r\n\tSelect,\r\n\tSelectProps,\r\n} from \"@mui/material\";\r\nimport { FC } from \"react\";\r\n\r\ntype StyledSelectMultipleProps = Omit<\r\n\tSelectProps<string[]>,\r\n\t\"multiple\"\r\n> & {\r\n\toptions?: { label: string; value: string }[];\r\n\tsubheader?: string;\r\n};\r\nexport const StyledSelectMultiple: FC<\r\n\tStyledSelectMultipleProps\r\n> = (props) => {\r\n\tconst { options, subheader, ...rest } = props;\r\n\tconst options_ = options ?? [];\r\n\treturn (\r\n\t\t<Select\r\n\t\t\t{...rest}\r\n\t\t\tmultiple\r\n\t\t>\r\n\t\t\t{subheader !== \"\" &&\r\n\t\t\t\tsubheader !== undefined && (\r\n\t\t\t\t\t<ListSubheader disableSticky>\r\n\t\t\t\t\t\t{subheader}\r\n\t\t\t\t\t</ListSubheader>\r\n\t\t\t\t)}\r\n\t\t\t{options_.map(({ value, label }, index) => (\r\n\t\t\t\t<MenuItem\r\n\t\t\t\t\tdisableRipple\r\n\t\t\t\t\tkey={`${value}-${index}`}\r\n\t\t\t\t\tvalue={value}\r\n\t\t\t\t>\r\n\t\t\t\t\t{label}\r\n\t\t\t\t</MenuItem>\r\n\t\t\t))}\r\n\t\t</Select>\r\n\t);\r\n};\r\n","import {\r\n\tTextField,\r\n\tTextFieldProps,\r\n} from \"@mui/material\";\r\nimport {\r\n\tChangeEvent,\r\n\tFC,\r\n\tKeyboardEvent,\r\n} from \"react\";\r\n\r\ntype StyledTextFieldProps = Omit<\r\n\tTextFieldProps,\r\n\t\"onChange\"\r\n> & {\r\n\tonEnter?: () => void;\r\n\tonChange?: (v: string) => void;\r\n};\r\nexport const StyledTextField: FC<\r\n\tStyledTextFieldProps\r\n> = (props) => {\r\n\tconst { onEnter, onChange, ...rest } = props;\r\n\r\n\tconst handleKeyUp = (\r\n\t\te: KeyboardEvent<HTMLDivElement>,\r\n\t) => {\r\n\t\tif (\r\n\t\t\te.key === \"Enter\" &&\r\n\t\t\tonEnter !== undefined\r\n\t\t) {\r\n\t\t\tconsole.log(\"entered\");\r\n\t\t\tonEnter();\r\n\t\t\treturn;\r\n\t\t}\r\n\t};\r\n\tconst handleChange = (\r\n\t\te: ChangeEvent<\r\n\t\t\tHTMLInputElement | HTMLTextAreaElement\r\n\t\t>,\r\n\t) => {\r\n\t\tif (onChange !== undefined) {\r\n\t\t\tonChange(e.target.value.normalize());\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<TextField\r\n\t\t\t{...rest}\r\n\t\t\tonKeyUp={handleKeyUp}\r\n\t\t\tonChange={handleChange}\r\n\t\t/>\r\n\t);\r\n};\r\n","import {\r\n\tClearRounded,\r\n\tFilterListRounded,\r\n} from \"@mui/icons-material\";\r\nimport {\r\n\tBox,\r\n\tCollapse,\r\n\tIconButton,\r\n\tList,\r\n\tListItem,\r\n\tListItemText,\r\n\tSelectChangeEvent,\r\n\tStack,\r\n\tToolbar,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport {\r\n\tREPO_FILTER_STATUS_OPTIONS,\r\n\tREPO_FILTER_TOPIC_MATCH_STRATEGY_OPTIONS,\r\n\tREPO_FILTER_VISIBILITY_OPTIONS,\r\n} from \"constants/REPO_FILTER_OPTIONS\";\r\nimport {\r\n\tFC,\r\n\tFragment,\r\n\tReactNode,\r\n\tuseState,\r\n} from \"react\";\r\nimport {\r\n\tLink,\r\n\tuseSubmit,\r\n} from \"react-router-dom\";\r\nimport {\r\n\torderByBoolean,\r\n\torderByString,\r\n} from \"~core/sorting\";\r\nimport { normalizeDateString } from \"~core/time\";\r\nimport {\r\n\tgetRepoFilterPrefStatus,\r\n\tgetRepoFilterPrefTopicMatchStrategy,\r\n\tgetRepoFilterPrefVisibility,\r\n} from \"~database/preferences\";\r\nimport { GenericSelectOptions } from \"~types/generics\";\r\nimport { RepoSchema } from \"~types/schemas\";\r\nimport { StyledDataTable } from \"./StyledDataTable\";\r\nimport { StyledSelect } from \"./StyledSelect\";\r\nimport { StyledSelectMultiple } from \"./StyledSelectMultiple\";\r\nimport { StyledTextField } from \"./StyledTextField\";\r\n\r\ntype DataCell = {\r\n\tid: keyof RepoSchema;\r\n\tlabel: string;\r\n\trender: (repo: RepoSchema) => ReactNode;\r\n};\r\nconst COLUMN_DEFINITION: DataCell[] = [\r\n\t{\r\n\t\tid: \"full_name\",\r\n\t\tlabel: \"Name\",\r\n\t\trender: (repo) => (\r\n\t\t\t<Typography\r\n\t\t\t\tcomponent={Link}\r\n\t\t\t\tto={`/repositories/${repo.full_name}`}\r\n\t\t\t>\r\n\t\t\t\t{repo.full_name}\r\n\t\t\t</Typography>\r\n\t\t),\r\n\t},\r\n\t{\r\n\t\tid: \"is_archived\",\r\n\t\tlabel: \"Status\",\r\n\t\trender: (repo) =>\r\n\t\t\trepo.is_archived ? \"Archived\" : \"Active\",\r\n\t},\r\n\t{\r\n\t\tid: \"is_private\",\r\n\t\tlabel: \"Visibility\",\r\n\t\trender: (repo) =>\r\n\t\t\trepo.is_private ? \"Private\" : \"Public\",\r\n\t},\r\n\t{\r\n\t\tid: \"pushed_at\",\r\n\t\tlabel: \"Last pushed\",\r\n\t\trender: (repo) =>\r\n\t\t\tnormalizeDateString(\r\n\t\t\t\trepo.pushed_at,\r\n\t\t\t\t\"Never\",\r\n\t\t\t),\r\n\t},\r\n\t{\r\n\t\tid: \"updated_at\",\r\n\t\tlabel: \"Last updated\",\r\n\t\trender: (repo) =>\r\n\t\t\tnormalizeDateString(\r\n\t\t\t\trepo.updated_at,\r\n\t\t\t\t\"Never\",\r\n\t\t\t),\r\n\t},\r\n\t{\r\n\t\tid: \"created_at\",\r\n\t\tlabel: \"Created\",\r\n\t\trender: (repo) =>\r\n\t\t\tnormalizeDateString(\r\n\t\t\t\trepo.created_at,\r\n\t\t\t\t\"Unknown\",\r\n\t\t\t),\r\n\t},\r\n];\r\n\r\nconst getOrderingFn = (\r\n\tproperty: keyof RepoSchema,\r\n):\r\n\t| ((a: RepoSchema, b: RepoSchema) => number)\r\n\t| undefined => {\r\n\tswitch (property) {\r\n\t\tcase \"is_archived\":\r\n\t\tcase \"is_private\":\r\n\t\t\treturn (a, b) =>\r\n\t\t\t\torderByBoolean(\r\n\t\t\t\t\ta[property] as\r\n\t\t\t\t\t\t| boolean\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t\tb[property] as\r\n\t\t\t\t\t\t| boolean\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t);\r\n\t\tcase \"full_name\":\r\n\t\tcase \"pushed_at\":\r\n\t\tcase \"created_at\":\r\n\t\tcase \"updated_at\":\r\n\t\t\treturn (a, b) =>\r\n\t\t\t\torderByString(\r\n\t\t\t\t\ta[property] as\r\n\t\t\t\t\t\t| string\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t\tb[property] as\r\n\t\t\t\t\t\t| string\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t);\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\ntype WrappableListItemProps = {\r\n\tchildren: ReactNode;\r\n\ttext: string;\r\n};\r\nconst WrappableListItem: FC<\r\n\tWrappableListItemProps\r\n> = (props) => {\r\n\tconst { text, children } = props;\r\n\treturn (\r\n\t\t<ListItem disableGutters>\r\n\t\t\t<Stack\r\n\t\t\t\twidth=\"100%\"\r\n\t\t\t\tdisplay=\"flex\"\r\n\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\tflexWrap=\"wrap\"\r\n\t\t\t\talignItems=\"start\"\r\n\t\t\t\tjustifyContent=\"space-between\"\r\n\t\t\t>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twidth: \"max(200px, 40%)\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{text}\r\n\t\t\t\t</ListItemText>\r\n\t\t\t\t<Stack\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\t\tminWidth=\"max(200px, 25%)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</Stack>\r\n\t\t\t</Stack>\r\n\t\t</ListItem>\r\n\t);\r\n};\r\n\r\ntype RepoDataTableProps = {\r\n\tdisableFilter?: boolean;\r\n\torderBy?: keyof RepoSchema;\r\n\trepos: RepoSchema[];\r\n\ttopicOptions?: GenericSelectOptions<string>[];\r\n\tname?: string;\r\n\ttopics?: string[];\r\n\ttopicMatchStrategy?: string;\r\n\tvisibility?: string;\r\n\tstatus?: string;\r\n};\r\nexport const RepoDataTable: React.FC<\r\n\tRepoDataTableProps\r\n> = (props) => {\r\n\tconst {\r\n\t\torderBy,\r\n\t\tdisableFilter,\r\n\t\trepos,\r\n\t\ttopicOptions: topicOptions_,\r\n\t\tname: name_,\r\n\t\ttopicMatchStrategy: topicMatchStrategy_,\r\n\t\tstatus: status_,\r\n\t\ttopics: topics_,\r\n\t\tvisibility: visibility_,\r\n\t} = props;\r\n\r\n\tconst submit = useSubmit();\r\n\r\n\tconst [name, setName] = useState(name_ || \"\");\r\n\tconst topics = topics_ ?? [];\r\n\tconst topicMatchStrategy =\r\n\t\ttopicMatchStrategy_ ||\r\n\t\tgetRepoFilterPrefTopicMatchStrategy();\r\n\tconst visibility =\r\n\t\tvisibility_ || getRepoFilterPrefVisibility();\r\n\tconst status =\r\n\t\tstatus_ || getRepoFilterPrefStatus();\r\n\r\n\tconst handleSubmit = (\r\n\t\tkey: string,\r\n\t\tvalue: string,\r\n\t) => {\r\n\t\tsubmit(\r\n\t\t\t{\r\n\t\t\t\tname,\r\n\t\t\t\ttopics,\r\n\t\t\t\ttopicMatchStrategy,\r\n\t\t\t\tvisibility,\r\n\t\t\t\tstatus,\r\n\t\t\t\t[key]: value,\r\n\t\t\t},\r\n\t\t\t{ action: \"./\", method: \"get\" },\r\n\t\t);\r\n\t};\r\n\r\n\tconst handleNameSubmit = () => {\r\n\t\thandleSubmit(\"name\", name);\r\n\t};\r\n\tconst handleTopicMatchStrategyChange = (\r\n\t\tevent: SelectChangeEvent<string>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\"topicMatchStrategy\", value);\r\n\t};\r\n\tconst handleStatusChange = (\r\n\t\tevent: SelectChangeEvent<string>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\"status\", value);\r\n\t};\r\n\tconst handleVisibilityChange = (\r\n\t\tevent: SelectChangeEvent<string>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\"visibility\", value);\r\n\t};\r\n\tconst handleTopicsChange = (\r\n\t\tevent: SelectChangeEvent<string[]>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\"topics\", value.toString());\r\n\t};\r\n\tconst handleTopicsReset = () => {\r\n\t\thandleSubmit(\"topics\", \"\");\r\n\t};\r\n\r\n\tconst [filterOpen, setFilterOpen] =\r\n\t\tuseState(false);\r\n\tconst toggleFilter = () => {\r\n\t\tsetFilterOpen(!filterOpen);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Box>\r\n\t\t\t{!disableFilter && (\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t<Toolbar\r\n\t\t\t\t\t\tdisableGutters\r\n\t\t\t\t\t\tvariant=\"dense\"\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t\tflexWrap: \"wrap\",\r\n\t\t\t\t\t\t\tgap: 1,\r\n\t\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\t\tjustifyContent: \"space-between\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Stack\r\n\t\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\t\tdirection=\"row\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<StyledTextField\r\n\t\t\t\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Search repository\"\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tvalue={name}\r\n\t\t\t\t\t\t\t\tonChange={setName}\r\n\t\t\t\t\t\t\t\tonEnter={handleNameSubmit}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tonClick={toggleFilter}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<FilterListRounded />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</Stack>\r\n\t\t\t\t\t\t<Typography>\r\n\t\t\t\t\t\t\tShowing {repos.length}{\" \"}\r\n\t\t\t\t\t\t\t{repos.length === 1\r\n\t\t\t\t\t\t\t\t? \"repository\"\r\n\t\t\t\t\t\t\t\t: \"repositories\"}\r\n\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t\t<Collapse in={filterOpen}>\r\n\t\t\t\t\t\t<List disablePadding>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"Topics\">\r\n\t\t\t\t\t\t\t\t<StyledSelectMultiple\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsubheader=\"Topics\"\r\n\t\t\t\t\t\t\t\t\trenderValue={(value) =>\r\n\t\t\t\t\t\t\t\t\t\t`${value.length} selected`\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={topics}\r\n\t\t\t\t\t\t\t\t\toptions={topicOptions_}\r\n\t\t\t\t\t\t\t\t\tonChange={handleTopicsChange}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleTopicsReset}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ClearRounded />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"Topic match strategy\">\r\n\t\t\t\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={topicMatchStrategy}\r\n\t\t\t\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\t\t\t\tREPO_FILTER_TOPIC_MATCH_STRATEGY_OPTIONS\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\thandleTopicMatchStrategyChange\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"Visibility\">\r\n\t\t\t\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={visibility}\r\n\t\t\t\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\t\t\t\tREPO_FILTER_VISIBILITY_OPTIONS\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\thandleVisibilityChange\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"Status\">\r\n\t\t\t\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={status}\r\n\t\t\t\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\t\t\t\tREPO_FILTER_STATUS_OPTIONS\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tonChange={handleStatusChange}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</Collapse>\r\n\t\t\t\t</Fragment>\r\n\t\t\t)}\r\n\t\t\t<StyledDataTable\r\n\t\t\t\titems={repos}\r\n\t\t\t\torderingFn={getOrderingFn}\r\n\t\t\t\tdefaultOrderBy={orderBy ?? \"pushed_at\"}\r\n\t\t\t\tcolumnDefinition={COLUMN_DEFINITION}\r\n\t\t\t/>\r\n\t\t</Box>\r\n\t);\r\n};\r\n","import {\r\n\tBreadcrumbs,\r\n\tBreadcrumbsProps,\r\n\tTypography,\r\n\tTypographyProps,\r\n} from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\ntype StyledBreadcrumbs = {\r\n\tpath: string;\r\n\tbreadcrumbsProps?: BreadcrumbsProps;\r\n\ttypographyProps?: Omit<TypographyProps, \"ref\">;\r\n};\r\nexport const StyledBreadcrumbs: FC<\r\n\tStyledBreadcrumbs\r\n> = (props) => {\r\n\tconst {\r\n\t\tpath: path,\r\n\t\tbreadcrumbsProps,\r\n\t\ttypographyProps,\r\n\t} = props;\r\n\r\n\tconst paths = path.normalize().split(\"/\");\r\n\tconst _paths = paths\r\n\t\t.filter((path) => path.trim().length > 0)\r\n\t\t.map((path, index) => (\r\n\t\t\t<Typography\r\n\t\t\t\t{...typographyProps}\r\n\t\t\t\tkey={`${index}-${path}`}\r\n\t\t\t\tcolor=\"text.secondary\"\r\n\t\t\t\twhiteSpace=\"nowrap\"\r\n\t\t\t\tcomponent={Link}\r\n\t\t\t\tto={\r\n\t\t\t\t\t\"/\" +\r\n\t\t\t\t\tpaths.slice(1, index + 1).join(\"/\")\r\n\t\t\t\t}\r\n\t\t\t\tsx={{\r\n\t\t\t\t\ttextDecoration: \"none\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{path}\r\n\t\t\t</Typography>\r\n\t\t));\r\n\r\n\treturn (\r\n\t\t<Breadcrumbs {...breadcrumbsProps}>\r\n\t\t\t{_paths}\r\n\t\t</Breadcrumbs>\r\n\t);\r\n};\r\n","import {\r\n\tDBSchema,\r\n\tIDBPDatabase,\r\n\topenDB,\r\n} from \"idb\";\r\nimport {\r\n\tCollectionSchema,\r\n\tRepoIssueCommentSchema,\r\n\tRepoIssueSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\n\r\ninterface Database extends DBSchema {\r\n\tcollections: {\r\n\t\tkey: string;\r\n\t\tvalue: CollectionSchema;\r\n\t};\r\n\trepos: {\r\n\t\tkey: string;\r\n\t\tvalue: RepoSchema;\r\n\t\tindexes: {\r\n\t\t\t\"by-full_name\": string;\r\n\t\t\t\"by-id\": number;\r\n\t\t};\r\n\t};\r\n\tissues: {\r\n\t\tkey: number;\r\n\t\tvalue: RepoIssueSchema;\r\n\t\tindexes: {\r\n\t\t\t\"by-repo_id\": number;\r\n\t\t};\r\n\t};\r\n\tissueComments: {\r\n\t\tkey: number;\r\n\t\tvalue: RepoIssueCommentSchema;\r\n\t\tindexes: {\r\n\t\t\t\"by-issue_id\": number;\r\n\t\t};\r\n\t};\r\n}\r\n\r\nconst db1 = (db: IDBPDatabase<Database>) => {\r\n\tconst repoStore = db.createObjectStore(\r\n\t\t\"repos\",\r\n\t\t{\r\n\t\t\tkeyPath: \"id\",\r\n\t\t\tautoIncrement: false,\r\n\t\t},\r\n\t);\r\n\trepoStore.createIndex(\r\n\t\t\"by-full_name\",\r\n\t\t\"full_name\",\r\n\t\t{\r\n\t\t\tunique: true,\r\n\t\t\tmultiEntry: false,\r\n\t\t},\r\n\t);\r\n\trepoStore.createIndex(\"by-id\", \"id\", {\r\n\t\tunique: true,\r\n\t\tmultiEntry: false,\r\n\t});\r\n\tconst issueStore = db.createObjectStore(\r\n\t\t\"issues\",\r\n\t\t{\r\n\t\t\tkeyPath: \"id\",\r\n\t\t\tautoIncrement: false,\r\n\t\t},\r\n\t);\r\n\tissueStore.createIndex(\r\n\t\t\"by-repo_id\",\r\n\t\t\"repo_id\",\r\n\t\t{ multiEntry: true, unique: false },\r\n\t);\r\n\tconst issueCommentStore = db.createObjectStore(\r\n\t\t\"issueComments\",\r\n\t\t{\r\n\t\t\tkeyPath: \"id\",\r\n\t\t\tautoIncrement: false,\r\n\t\t},\r\n\t);\r\n\tissueCommentStore.createIndex(\r\n\t\t\"by-issue_id\",\r\n\t\t\"issue_id\",\r\n\t\t{ multiEntry: true, unique: false },\r\n\t);\r\n};\r\n\r\nconst db2 = (db: IDBPDatabase<Database>) => {\r\n\tdb.createObjectStore(\"collections\", {\r\n\t\tkeyPath: \"name\",\r\n\t\tautoIncrement: false,\r\n\t});\r\n};\r\n\r\nexport const dbPromise = openDB<Database>(\r\n\t\"primary\",\r\n\t2,\r\n\t{\r\n\t\tupgrade(db, oldVersion) {\r\n\t\t\tif (oldVersion < 1) {\r\n\t\t\t\tdb1(db);\r\n\t\t\t}\r\n\t\t\tif (oldVersion < 2) {\r\n\t\t\t\tdb2(db);\r\n\t\t\t}\r\n\t\t},\r\n\t},\r\n);\r\n","import { Octokit } from \"octokit\";\r\nimport {\r\n\tRepoIssueCommentSchema,\r\n\tRepoIssueSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\n\r\nconst getToken = () => {\r\n\tconst token = localStorage.getItem(\r\n\t\t\"personal-access-token\",\r\n\t);\r\n\tif (token === null) {\r\n\t\treturn \"-1\";\r\n\t}\r\n\treturn token;\r\n};\r\n\r\nconst getOctokit = () => {\r\n\tconst token = getToken();\r\n\treturn new Octokit({ auth: token });\r\n};\r\n\r\nexport const getRepo = async (\r\n\tfullName: string,\r\n) => {\r\n\tconst repos = await getRepos();\r\n\tfor (const repo of repos) {\r\n\t\tif (repo.full_name === fullName) {\r\n\t\t\treturn repo;\r\n\t\t}\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nexport const getRepos = async () => {\r\n\tconst octokit = getOctokit();\r\n\tconst pages = await octokit.paginate(\r\n\t\t\"GET /user/repos\",\r\n\t);\r\n\tconst req = pages.map(\r\n\t\tasync ({\r\n\t\t\tname,\r\n\t\t\tfull_name,\r\n\t\t\ttopics,\r\n\t\t\tcreated_at,\r\n\t\t\tupdated_at,\r\n\t\t\tdescription,\r\n\t\t\tid,\r\n\t\t\thtml_url,\r\n\t\t\thomepage,\r\n\t\t\tpushed_at,\r\n\t\t\tarchived: is_archived,\r\n\t\t\tprivate: is_private,\r\n\t\t}) => ({\r\n\t\t\tid,\r\n\t\t\thtml_url,\r\n\t\t\thomepage,\r\n\t\t\tpushed_at,\r\n\t\t\tname,\r\n\t\t\tfull_name,\r\n\t\t\tdescription,\r\n\t\t\ttopics,\r\n\t\t\tcreated_at,\r\n\t\t\tupdated_at,\r\n\t\t\tis_archived,\r\n\t\t\tis_private,\r\n\t\t\treadme: await getRepoReadMe(\r\n\t\t\t\tfull_name,\r\n\t\t\t).catch((err) => {\r\n\t\t\t\tif (err.status === 404) {\r\n\t\t\t\t\treturn undefined;\r\n\t\t\t\t}\r\n\t\t\t\tthrow err;\r\n\t\t\t}),\r\n\t\t}),\r\n\t);\r\n\r\n\tconst repos: RepoSchema[] = await Promise.all(\r\n\t\treq,\r\n\t);\r\n\r\n\treturn repos;\r\n};\r\n\r\nconst getRepoReadMe = async (\r\n\tfullName: string,\r\n) => {\r\n\tconst ocktokit = getOctokit();\r\n\tconst [owner, repo] = fullName.split(\"/\");\r\n\tconst res = await ocktokit.request(\r\n\t\t\"GET /repos/{owner}/{repo}/readme\",\r\n\t\t{\r\n\t\t\towner,\r\n\t\t\trepo,\r\n\t\t},\r\n\t);\r\n\treturn res.data.content;\r\n};\r\n\r\nexport const getRepoIssues = async (\r\n\tfullName: string,\r\n\trepoId: number,\r\n) => {\r\n\tconst ocktokit = getOctokit();\r\n\tconst [owner, repo] = fullName.split(\"/\");\r\n\tconst response = await ocktokit.paginate(\r\n\t\t\"GET /repos/{owner}/{repo}/issues\",\r\n\t\t{\r\n\t\t\towner,\r\n\t\t\trepo,\r\n\t\t\tstate: \"all\",\r\n\t\t},\r\n\t);\r\n\tconst issues: RepoIssueSchema[] = response.map(\r\n\t\t({\r\n\t\t\tid,\r\n\t\t\thtml_url,\r\n\t\t\tnumber: issue_number,\r\n\t\t\ttitle,\r\n\t\t\tstate,\r\n\t\t\tlocked,\r\n\t\t\tcreated_at,\r\n\t\t\tupdated_at,\r\n\t\t\tclosed_at,\r\n\t\t\tbody,\r\n\t\t\tuser,\r\n\t\t}) => ({\r\n\t\t\towner_type:\r\n\t\t\t\tuser === null ? null : user.type,\r\n\t\t\trepo_id: repoId,\r\n\t\t\trepo_full_name: fullName,\r\n\t\t\tid,\r\n\t\t\thtml_url,\r\n\t\t\tissue_number,\r\n\t\t\ttitle,\r\n\t\t\tstate,\r\n\t\t\tlocked,\r\n\t\t\tcreated_at,\r\n\t\t\tupdated_at,\r\n\t\t\tclosed_at,\r\n\t\t\tbody,\r\n\t\t}),\r\n\t);\r\n\treturn issues;\r\n};\r\n\r\nexport const getRepoIssueComment = async (\r\n\tfullName: string,\r\n\tissueNumber: number,\r\n\tissueId: number,\r\n) => {\r\n\tconst ocktokit = getOctokit();\r\n\tconst [owner, repo] = fullName.split(\"/\");\r\n\tconst response = await ocktokit.paginate(\r\n\t\t\"GET /repos/{owner}/{repo}/issues/{issue_number}/comments\",\r\n\t\t{\r\n\t\t\towner,\r\n\t\t\trepo,\r\n\t\t\tissue_number: issueNumber,\r\n\t\t},\r\n\t);\r\n\tconst comments: RepoIssueCommentSchema[] =\r\n\t\tresponse.map(\r\n\t\t\t({\r\n\t\t\t\tid,\r\n\t\t\t\thtml_url,\r\n\t\t\t\tcreated_at,\r\n\t\t\t\tupdated_at,\r\n\t\t\t\tbody,\r\n\t\t\t}) => ({\r\n\t\t\t\tissue_id: issueId,\r\n\t\t\t\thtml_url,\r\n\t\t\t\tid,\r\n\t\t\t\tcreated_at,\r\n\t\t\t\tupdated_at,\r\n\t\t\t\tbody,\r\n\t\t\t}),\r\n\t\t);\r\n\treturn comments;\r\n};\r\n","import { dbPromise } from \"~database/migration\";\r\nimport {\r\n\tRepoIssueCommentSchema,\r\n\tRepoIssueSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\nimport {\r\n\tgetRepoIssueComment,\r\n\tgetRepoIssues,\r\n\tgetRepos,\r\n} from \"./api\";\r\n\r\nexport const getCachedRepos = async () => {\r\n\treturn (await dbPromise).getAll(\"repos\");\r\n};\r\n\r\nexport const getCachedRepo = async (\r\n\tfullName: string,\r\n) => {\r\n\treturn (await dbPromise).getFromIndex(\r\n\t\t\"repos\",\r\n\t\t\"by-full_name\",\r\n\t\tfullName,\r\n\t);\r\n};\r\n\r\nexport const getCachedTopics = async () => {\r\n\tconst repos = await getCachedRepos();\r\n\tconst uniqueTopics = new Set<string>();\r\n\tfor (const repo of repos) {\r\n\t\tif (repo.topics === undefined) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tfor (const topic of repo.topics) {\r\n\t\t\tuniqueTopics.add(topic);\r\n\t\t}\r\n\t}\r\n\tconst topics = [...uniqueTopics];\r\n\ttopics.sort();\r\n\treturn topics;\r\n};\r\n\r\nexport const getCachedIssues = async () => {\r\n\treturn dbPromise.then((db) =>\r\n\t\tdb.getAll(\"issues\"),\r\n\t);\r\n};\r\n\r\nexport const getCachedRepoIssues = async (\r\n\trepoFullName: string,\r\n) => {\r\n\tconst repo = await getCachedRepo(repoFullName);\r\n\tif (repo === undefined) {\r\n\t\treturn [];\r\n\t}\r\n\treturn (await dbPromise).getAllFromIndex(\r\n\t\t\"issues\",\r\n\t\t\"by-repo_id\",\r\n\t\trepo.id,\r\n\t);\r\n};\r\n\r\nexport const getCachedRepoIssue = async (\r\n\trepoFullName: string,\r\n\tissueNumber: number,\r\n) => {\r\n\tconst issues = await getCachedRepoIssues(\r\n\t\trepoFullName,\r\n\t);\r\n\tfor (const issue of issues) {\r\n\t\tif (issue.issue_number === issueNumber) {\r\n\t\t\treturn issue;\r\n\t\t}\r\n\t}\r\n\treturn undefined;\r\n};\r\n\r\nexport const getCachedIssueComments = async (\r\n\tissueId: number,\r\n) => {\r\n\treturn (await dbPromise).getAllFromIndex(\r\n\t\t\"issueComments\",\r\n\t\t\"by-issue_id\",\r\n\t\tissueId,\r\n\t);\r\n};\r\n\r\nconst updateCachedRepos = async (\r\n\trepos: RepoSchema[],\r\n) => {\r\n\tconst db = await dbPromise;\r\n\tconst req = repos.map((repo) =>\r\n\t\tdb.put(\"repos\", repo),\r\n\t);\r\n\tconst res = await Promise.all(req);\r\n\treturn res;\r\n};\r\n\r\nconst updateCachedRepoIssues = async (\r\n\tissues: RepoIssueSchema[],\r\n) => {\r\n\tconst db = await dbPromise;\r\n\tconst req = issues.map((issue) =>\r\n\t\tdb.put(\"issues\", issue),\r\n\t);\r\n\tconst res = await Promise.all(req);\r\n\treturn res;\r\n};\r\n\r\nconst updateCachedRepoIssueComments = async (\r\n\tissueComments: RepoIssueCommentSchema[],\r\n) => {\r\n\tconst db = await dbPromise;\r\n\treturn await Promise.all(\r\n\t\tissueComments.map((comment) =>\r\n\t\t\tdb.put(\"issueComments\", comment),\r\n\t\t),\r\n\t);\r\n};\r\n\r\nexport const syncCachedRepos = async (\r\n\tonFailure: (err: any) => void,\r\n) => {\r\n\treturn await getRepos().then(\r\n\t\t(res) => {\r\n\t\t\tupdateCachedRepos(res);\r\n\t\t\treturn [true];\r\n\t\t},\r\n\t\t(err) => {\r\n\t\t\tonFailure(err);\r\n\t\t\treturn [false];\r\n\t\t},\r\n\t);\r\n};\r\nexport const syncCachedRepoIssues = async (\r\n\tonFailure: (err: any) => void,\r\n) => {\r\n\tconst cachedRepos = await getCachedRepos();\r\n\treturn await Promise.all(\r\n\t\tcachedRepos.map(async (repo) => {\r\n\t\t\treturn await getRepoIssues(\r\n\t\t\t\trepo.full_name,\r\n\t\t\t\trepo.id,\r\n\t\t\t).then(\r\n\t\t\t\t(res) => {\r\n\t\t\t\t\tupdateCachedRepoIssues(res);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\t(err) => {\r\n\t\t\t\t\tonFailure(err);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t}),\r\n\t);\r\n};\r\nexport const syncCachedRepoIssueComments = async (\r\n\tonFailure: (err: any) => void,\r\n) => {\r\n\tconst cachedIssues = await getCachedIssues();\r\n\treturn await Promise.all(\r\n\t\tcachedIssues.map(async (issue) => {\r\n\t\t\treturn await getRepoIssueComment(\r\n\t\t\t\tissue.repo_full_name,\r\n\t\t\t\tissue.issue_number,\r\n\t\t\t\tissue.id,\r\n\t\t\t).then(\r\n\t\t\t\t(res) => {\r\n\t\t\t\t\tupdateCachedRepoIssueComments(res);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t},\r\n\t\t\t\t(err) => {\r\n\t\t\t\t\tonFailure(err);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t},\r\n\t\t\t);\r\n\t\t}),\r\n\t);\r\n};\r\n\r\nexport const getCollections = async () => {\r\n\tconst db = await dbPromise;\r\n\treturn await db.getAll(\"collections\");\r\n};\r\nexport const getCollection = async (\r\n\tname: string,\r\n) => {\r\n\tconst db = await dbPromise;\r\n\treturn await db.get(\"collections\", name);\r\n};\r\n\r\nexport const addCollection = async (\r\n\tname: string,\r\n\tdescription: string,\r\n\trepos: string[],\r\n) => {\r\n\tconst db = await dbPromise;\r\n\treturn db.add(\"collections\", {\r\n\t\tname,\r\n\t\tdescription,\r\n\t\trepos,\r\n\t});\r\n};\r\n\r\nexport const updateCollection = async (\r\n\tname: string,\r\n\tdescription: string,\r\n\trepos: string[],\r\n) => {\r\n\tconst db = await dbPromise;\r\n\treturn db.put(\"collections\", {\r\n\t\tname,\r\n\t\tdescription,\r\n\t\trepos,\r\n\t});\r\n};\r\n","import {\r\n\tCloseRounded,\r\n\tListRounded,\r\n} from \"@mui/icons-material\";\r\nimport {\r\n\tAppBar,\r\n\tBox,\r\n\tDivider,\r\n\tDrawer,\r\n\tIconButton,\r\n\tList,\r\n\tListItem,\r\n\tListItemButton,\r\n\tListItemText,\r\n\tToolbar,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport {\r\n\tFC,\r\n\tFragment,\r\n\tReactNode,\r\n\tuseEffect,\r\n\tuseRef,\r\n\tuseState,\r\n} from \"react\";\r\nimport { useSubmit } from \"react-router-dom\";\r\n\r\nconst nav: { label: string; path: string }[] = [\r\n\t{ label: \"~\", path: \"/\" },\r\n\t{\r\n\t\tlabel: \"repositories\",\r\n\t\tpath: \"/repositories\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"issues\",\r\n\t\tpath: \"/issues\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"collections\",\r\n\t\tpath: \"/collections\",\r\n\t},\r\n\t{ label: \"settings\", path: \"/settings\" },\r\n];\r\n\r\ntype WithAppBarProps = {\r\n\tlocation: ReactNode;\r\n\tchildren: ReactNode;\r\n\tseconadaryAction?: ReactNode;\r\n};\r\nexport const WithAppBar: FC<WithAppBarProps> = (\r\n\tprops,\r\n) => {\r\n\tconst { location, children, seconadaryAction } =\r\n\t\tprops;\r\n\tconst submit = useSubmit();\r\n\tconst [drawerOpen, setDrawerOpen] =\r\n\t\tuseState(false);\r\n\tconst toggleDrawer = () => {\r\n\t\tsetDrawerOpen(!drawerOpen);\r\n\t};\r\n\tconst appBarRef = useRef<HTMLElement | null>(\r\n\t\tnull,\r\n\t);\r\n\tconst [contentHeight, setContentHeight] =\r\n\t\tuseState(\"0vh\");\r\n\r\n\tuseEffect(() => {\r\n\t\tif (\r\n\t\t\tappBarRef === null ||\r\n\t\t\tappBarRef.current === null\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst appBarHeight =\r\n\t\t\tappBarRef.current.getBoundingClientRect()\r\n\t\t\t\t.height;\r\n\r\n\t\tsetContentHeight(\r\n\t\t\t`calc(100svh - ${appBarHeight}px)`,\r\n\t\t);\r\n\t}, [appBarRef]);\r\n\r\n\tconst redirectPath = (path: string) => {\r\n\t\tsubmit({}, { action: path, method: \"get\" });\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<Box maxWidth=\"100vw\">\r\n\t\t\t\t<AppBar\r\n\t\t\t\t\tref={appBarRef}\r\n\t\t\t\t\tposition=\"relative\"\r\n\t\t\t\t\tvariant=\"elevation\"\r\n\t\t\t\t\televation={0}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Toolbar\r\n\t\t\t\t\t\tvariant=\"dense\"\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\t\t\t\tflexWrap: \"nowrap\",\r\n\t\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\t\tjustifyContent: \"space-between\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tonClick={toggleDrawer}\r\n\t\t\t\t\t\t\tsx={{ flexGrow: 0 }}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ListRounded />\r\n\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t{location}\r\n\t\t\t\t\t\t{seconadaryAction}\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t\t<Divider\r\n\t\t\t\t\t\tflexItem\r\n\t\t\t\t\t\tvariant=\"fullWidth\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</AppBar>\r\n\t\t\t\t<Box\r\n\t\t\t\t\theight={contentHeight}\r\n\t\t\t\t\toverflow=\"auto\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</Box>\r\n\t\t\t</Box>\r\n\t\t\t<Drawer\r\n\t\t\t\topen={drawerOpen}\r\n\t\t\t\tonClose={toggleDrawer}\r\n\t\t\t\tPaperProps={{\r\n\t\t\t\t\tsquare: true,\r\n\t\t\t\t\tvariant: \"outlined\",\r\n\t\t\t\t\televation: 0,\r\n\t\t\t\t\tsx: {\r\n\t\t\t\t\t\twidth: 240,\r\n\t\t\t\t\t\theight: \"100%\",\r\n\t\t\t\t\t\tborderTopWidth: 0,\r\n\t\t\t\t\t\tborderLeftWidth: 0,\r\n\t\t\t\t\t\tborderBottomWidth: 0,\r\n\t\t\t\t\t},\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Toolbar\r\n\t\t\t\t\tvariant=\"dense\"\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\tjustifyContent: \"space-between\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tonClick={toggleDrawer}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<CloseRounded />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t<Typography fontWeight=\"bold\">\r\n\t\t\t\t\t\tNavigation\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t\t<Divider />\r\n\t\t\t\t<List\r\n\t\t\t\t\tdisablePadding\r\n\t\t\t\t\tdense\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twordBreak: \"break-word\",\r\n\t\t\t\t\t\twhiteSpace: \"wrap\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{nav.map(({ label, path }) => (\r\n\t\t\t\t\t\t<ListItem\r\n\t\t\t\t\t\t\tdisableGutters\r\n\t\t\t\t\t\t\tkey={path}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ListItemButton\r\n\t\t\t\t\t\t\t\tonClick={() => redirectPath(path)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<ListItemText>\r\n\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t\t</ListItemButton>\r\n\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</List>\r\n\t\t\t</Drawer>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n","import {\r\n\tBox,\r\n\tButton,\r\n\tSelectChangeEvent,\r\n} from \"@mui/material\";\r\nimport { FC, ReactNode, useState } from \"react\";\r\nimport {\r\n\tuseLoaderData,\r\n\tuseSubmit,\r\n} from \"react-router-dom\";\r\nimport { RepoDataTable } from \"~components/RepoDataTable\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { StyledSelectMultiple } from \"~components/StyledSelectMultiple\";\r\nimport { updateCollection } from \"~database/cached\";\r\nimport { GenericSelectOptions } from \"~types/generics\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nexport const CollectionDetailsPage: FC = () => {\r\n\tconst { collection, repos, collectedRepos } =\r\n\t\tuseLoaderData() as LoaderData;\r\n\tconst submit = useSubmit();\r\n\r\n\tconst [items, setCollected] = useState(\r\n\t\tcollection.repos,\r\n\t);\r\n\r\n\tconst options: GenericSelectOptions<string>[] =\r\n\t\trepos.map((value) => ({\r\n\t\t\tlabel: value,\r\n\t\t\tvalue,\r\n\t\t}));\r\n\r\n\tconst handleItemChange = (\r\n\t\tevent: SelectChangeEvent<string[]>,\r\n\t\t_: ReactNode,\r\n\t) => {\r\n\t\tconst values = event.target.value\r\n\t\t\t.toString()\r\n\t\t\t.split(\",\");\r\n\t\tsetCollected(values);\r\n\t};\r\n\tconst handleSubmit = async () => {\r\n\t\tconst res = await updateCollection(\r\n\t\t\tcollection.name,\r\n\t\t\tcollection.description ?? \"\",\r\n\t\t\titems,\r\n\t\t);\r\n\t\tif (res) {\r\n\t\t\tsubmit({}, { action: \"./\", method: \"get\" });\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath={`~/collections/${collection.name}`}\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: { flexGrow: 1 },\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Box\r\n\t\t\t\tpaddingTop={2}\r\n\t\t\t\tpaddingX={2}\r\n\t\t\t>\r\n\t\t\t\t<StyledSelectMultiple\r\n\t\t\t\t\tfullWidth\r\n\t\t\t\t\toptions={options}\r\n\t\t\t\t\tvalue={items}\r\n\t\t\t\t\tonChange={handleItemChange}\r\n\t\t\t\t/>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tdisableElevation\r\n\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\tonClick={handleSubmit}\r\n\t\t\t\t>\r\n\t\t\t\t\tSave\r\n\t\t\t\t</Button>\r\n\t\t\t\t<RepoDataTable repos={collectedRepos} />\r\n\t\t\t</Box>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { LoaderFunction } from \"react-router-dom\";\r\nimport {\r\n\tgetCachedRepo,\r\n\tgetCachedRepos,\r\n\tgetCollection,\r\n} from \"~database/index\";\r\nimport {\r\n\tCollectionSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\trepos: string[];\r\n\tcollection: CollectionSchema;\r\n\tcollectedRepos: RepoSchema[];\r\n};\r\nexport const loader: LoaderFunction = async ({\r\n\tparams,\r\n}): Promise<LoaderData> => {\r\n\tconst nameParam = params.collectionName;\r\n\tif (nameParam === undefined) {\r\n\t\tthrow new Response(\"\", {\r\n\t\t\tstatus: 400,\r\n\t\t\tstatusText: \"Bad requeset\",\r\n\t\t});\r\n\t}\r\n\r\n\tconst collection = await getCollection(\r\n\t\tnameParam,\r\n\t);\r\n\tif (collection === undefined) {\r\n\t\tthrow new Response(\"\", {\r\n\t\t\tstatus: 400,\r\n\t\t\tstatusText: \"Bad requeset\",\r\n\t\t});\r\n\t}\r\n\r\n\tdocument.title = nameParam;\r\n\tconst repos = (await getCachedRepos()).map(\r\n\t\t({ full_name }) => full_name,\r\n\t);\r\n\r\n\tconst reposReqs = collection.repos.map((repo) =>\r\n\t\tgetCachedRepo(repo),\r\n\t);\r\n\tconst collectedRepos = (\r\n\t\tawait Promise.all(reposReqs)\r\n\t).filter(\r\n\t\t(repo) => repo !== undefined,\r\n\t) as RepoSchema[];\r\n\r\n\tconst loaderData: LoaderData = {\r\n\t\trepos,\r\n\t\tcollection,\r\n\t\tcollectedRepos,\r\n\t};\r\n\treturn loaderData;\r\n};\r\n","import {\r\n\tBox,\r\n\tButton,\r\n\tStack,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport { FC, useMemo, useState } from \"react\";\r\nimport {\r\n\tLink,\r\n\tuseLoaderData,\r\n\tuseSubmit,\r\n} from \"react-router-dom\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { StyledDataTable } from \"~components/StyledDataTable\";\r\nimport { StyledTextField } from \"~components/StyledTextField\";\r\nimport { orderByString } from \"~core/sorting\";\r\nimport { addCollection } from \"~database/cached\";\r\nimport { GenericDataCell } from \"~types/generics\";\r\nimport { CollectionSchema } from \"~types/schemas\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nconst COLUMN_DEFINITION: GenericDataCell<CollectionSchema>[] =\r\n\t[\r\n\t\t{\r\n\t\t\tlabel: \"Name\",\r\n\t\t\tid: \"name\",\r\n\t\t\trender: (collection) => (\r\n\t\t\t\t<Typography\r\n\t\t\t\t\tcomponent={Link}\r\n\t\t\t\t\tto={`/collections/${collection.name}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t{collection.name}\r\n\t\t\t\t</Typography>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\r\nconst orderingFn = (\r\n\tproperty: keyof CollectionSchema,\r\n):\r\n\t| ((\r\n\t\t\ta: CollectionSchema,\r\n\t\t\tb: CollectionSchema,\r\n\t  ) => number)\r\n\t| undefined => {\r\n\tswitch (property) {\r\n\t\tcase \"name\":\r\n\t\t\treturn (a, b) =>\r\n\t\t\t\torderByString(a.name, b.name);\r\n\t}\r\n};\r\n\r\nexport const CollectionListPage: FC = () => {\r\n\tconst { collections } =\r\n\t\tuseLoaderData() as LoaderData;\r\n\tconst { enqueueSnackbar } = useSnackbar();\r\n\tconst submit = useSubmit();\r\n\r\n\tconst usedNames = useMemo(() => {\r\n\t\treturn collections.map(({ name }) => name);\r\n\t}, [collections]);\r\n\r\n\tconst [name, setName] = useState(\"\");\r\n\tconst handleCollectionCreate = async () => {\r\n\t\tconst res = await addCollection(\r\n\t\t\tname,\r\n\t\t\t\"\",\r\n\t\t\t[],\r\n\t\t).then(\r\n\t\t\t() => {\r\n\t\t\t\tenqueueSnackbar({\r\n\t\t\t\t\tmessage: \"Added collection\",\r\n\t\t\t\t\tvariant: \"success\",\r\n\t\t\t\t});\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\t(err) => {\r\n\t\t\t\tenqueueSnackbar({\r\n\t\t\t\t\tmessage: String(err),\r\n\t\t\t\t\tvariant: \"error\",\r\n\t\t\t\t});\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t);\r\n\t\tif (res) {\r\n\t\t\tsubmit({}, { action: \"./\", method: \"get\" });\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath=\"~/collections\"\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: { flexGrow: 1 },\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Box\r\n\t\t\t\tpaddingTop={2}\r\n\t\t\t\tpaddingX={2}\r\n\t\t\t>\r\n\t\t\t\t<Stack\r\n\t\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tgap={1}\r\n\t\t\t\t>\r\n\t\t\t\t\t<StyledTextField\r\n\t\t\t\t\t\tcolor={\r\n\t\t\t\t\t\t\tusedNames.includes(name)\r\n\t\t\t\t\t\t\t\t? \"warning\"\r\n\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tplaceholder=\"Collection name\"\r\n\t\t\t\t\t\tvalue={name}\r\n\t\t\t\t\t\tonChange={setName}\r\n\t\t\t\t\t\tonEnter={handleCollectionCreate}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Button\r\n\t\t\t\t\t\tdisableElevation\r\n\t\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\t\tonClick={handleCollectionCreate}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tnew collection\r\n\t\t\t\t\t</Button>\r\n\t\t\t\t</Stack>\r\n\t\t\t\t<StyledDataTable\r\n\t\t\t\t\titems={collections}\r\n\t\t\t\t\tdefaultOrderBy=\"name\"\r\n\t\t\t\t\tcolumnDefinition={COLUMN_DEFINITION}\r\n\t\t\t\t\torderingFn={orderingFn}\r\n\t\t\t\t/>\r\n\t\t\t</Box>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { LoaderFunction } from \"react-router-dom\";\r\nimport { getCollections } from \"~database/index\";\r\nimport { CollectionSchema } from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\tcollections: CollectionSchema[];\r\n};\r\nexport const loader: LoaderFunction =\r\n\tasync (): Promise<LoaderData> => {\r\n\t\tdocument.title = \"collections\";\r\n\t\tconst collections = await getCollections();\r\n\t\tconst loaderData: LoaderData = {\r\n\t\t\tcollections,\r\n\t\t};\r\n\t\treturn loaderData;\r\n\t};\r\n","import {\r\n\tBox,\r\n\tContainer,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { useRouteError } from \"react-router\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\n\r\nexport const ErrorBoundry: FC = () => {\r\n\tconst { status, statusText } =\r\n\t\tuseRouteError() as {\r\n\t\t\tstatus: string;\r\n\t\t\tstatusText: string;\r\n\t\t};\r\n\treturn (\r\n\t\t<WithAppBar location={status}>\r\n\t\t\t<Container maxWidth=\"md\">\r\n\t\t\t\t<Box padding={4}>\r\n\t\t\t\t\t<Typography\r\n\t\t\t\t\t\tcomponent=\"h1\"\r\n\t\t\t\t\t\tvariant=\"h1\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{status}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<Typography\r\n\t\t\t\t\t\tparagraph\r\n\t\t\t\t\t\tcomponent=\"p\"\r\n\t\t\t\t\t\tvariant=\"body1\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{statusText}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t</Box>\r\n\t\t\t</Container>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import {\r\n\tClearRounded,\r\n\tFilterListRounded,\r\n} from \"@mui/icons-material\";\r\nimport {\r\n\tBox,\r\n\tCollapse,\r\n\tIconButton,\r\n\tList,\r\n\tListItem,\r\n\tListItemText,\r\n\tSelectChangeEvent,\r\n\tStack,\r\n\tToolbar,\r\n\tTypography,\r\n\tcapitalize,\r\n} from \"@mui/material\";\r\nimport {\r\n\tFC,\r\n\tFragment,\r\n\tReactNode,\r\n\tuseState,\r\n} from \"react\";\r\nimport {\r\n\tLink,\r\n\tuseSubmit,\r\n} from \"react-router-dom\";\r\nimport {\r\n\tISSUE_FILTER_OWNER_TYPE_OPTIONS,\r\n\tISSUE_FILTER_STATE_OPTIONS,\r\n} from \"~constants\";\r\nimport {\r\n\torderByNumber,\r\n\torderByString,\r\n} from \"~core/sorting\";\r\nimport { normalizeDateString } from \"~core/time\";\r\nimport {\r\n\tgetIssueFilterPrefOwnerType,\r\n\tgetIssueFilterPrefState,\r\n} from \"~database/preferences\";\r\nimport { GenericSelectOptions } from \"~types/generics\";\r\nimport { RepoIssueSchema } from \"~types/schemas\";\r\nimport { StyledDataTable } from \"./StyledDataTable\";\r\nimport { StyledSelect } from \"./StyledSelect\";\r\nimport { StyledSelectMultiple } from \"./StyledSelectMultiple\";\r\nimport { StyledTextField } from \"./StyledTextField\";\r\n\r\ntype HeadCell = {\r\n\tid: keyof RepoIssueSchema;\r\n\tlabel: string;\r\n\trender: (issue: RepoIssueSchema) => ReactNode;\r\n};\r\nconst COLUMN_DEFINITION: HeadCell[] = [\r\n\t{\r\n\t\tid: \"title\",\r\n\t\tlabel: \"Title\",\r\n\t\trender: (issue) => (\r\n\t\t\t<Typography\r\n\t\t\t\tcomponent={Link}\r\n\t\t\t\tto={`/repositories/${issue.repo_full_name}/issues/${issue.issue_number}`}\r\n\t\t\t>\r\n\t\t\t\t{issue.title}\r\n\t\t\t</Typography>\r\n\t\t),\r\n\t},\r\n\t{\r\n\t\tid: \"repo_full_name\",\r\n\t\tlabel: \"Repository\",\r\n\t\trender: (issue) => (\r\n\t\t\t<Typography\r\n\t\t\t\tcomponent={Link}\r\n\t\t\t\tto={`/repositories/${issue.repo_full_name}`}\r\n\t\t\t>\r\n\t\t\t\t{issue.repo_full_name}\r\n\t\t\t</Typography>\r\n\t\t),\r\n\t},\r\n\t{\r\n\t\tid: \"issue_number\",\r\n\t\tlabel: \"Issue number\",\r\n\t\trender: (issue) => issue.issue_number,\r\n\t},\r\n\t{\r\n\t\tid: \"owner_type\",\r\n\t\tlabel: \"Type\",\r\n\t\trender: (issue) => issue.owner_type,\r\n\t},\r\n\t{\r\n\t\tid: \"state\",\r\n\t\tlabel: \"State\",\r\n\t\trender: (issue) => capitalize(issue.state),\r\n\t},\r\n\t{\r\n\t\tid: \"updated_at\",\r\n\t\tlabel: \"Last updated\",\r\n\t\trender: (issue) =>\r\n\t\t\tnormalizeDateString(\r\n\t\t\t\tissue.updated_at,\r\n\t\t\t\t\"Never\",\r\n\t\t\t),\r\n\t},\r\n\t{\r\n\t\tid: \"created_at\",\r\n\t\tlabel: \"Created\",\r\n\t\trender: (issue) =>\r\n\t\t\tnormalizeDateString(\r\n\t\t\t\tissue.created_at,\r\n\t\t\t\t\"Unknown\",\r\n\t\t\t),\r\n\t},\r\n];\r\n\r\nconst getOrderingFn = (\r\n\tproperty: keyof RepoIssueSchema,\r\n) => {\r\n\tlet orderFn:\r\n\t\t| ((\r\n\t\t\t\ta: RepoIssueSchema,\r\n\t\t\t\tb: RepoIssueSchema,\r\n\t\t  ) => number)\r\n\t\t| undefined;\r\n\tswitch (property) {\r\n\t\tcase \"issue_number\":\r\n\t\t\torderFn = (a, b) => {\r\n\t\t\t\treturn orderByNumber(\r\n\t\t\t\t\ta[property] as\r\n\t\t\t\t\t\t| number\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t\tb[property] as\r\n\t\t\t\t\t\t| number\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t);\r\n\t\t\t};\r\n\t\t\tbreak;\r\n\t\tcase \"title\":\r\n\t\tcase \"repo_full_name\":\r\n\t\tcase \"owner_type\":\r\n\t\tcase \"state\":\r\n\t\tcase \"created_at\":\r\n\t\tcase \"updated_at\":\r\n\t\t\torderFn = (a, b) => {\r\n\t\t\t\treturn orderByString(\r\n\t\t\t\t\ta[property] as\r\n\t\t\t\t\t\t| string\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t\tb[property] as\r\n\t\t\t\t\t\t| string\r\n\t\t\t\t\t\t| undefined\r\n\t\t\t\t\t\t| null,\r\n\t\t\t\t);\r\n\t\t\t};\r\n\t}\r\n\treturn orderFn;\r\n};\r\n\r\ntype WrappableListItemProps = {\r\n\tchildren: ReactNode;\r\n\ttext: string;\r\n};\r\nconst WrappableListItem: FC<\r\n\tWrappableListItemProps\r\n> = (props) => {\r\n\tconst { text, children } = props;\r\n\treturn (\r\n\t\t<ListItem disableGutters>\r\n\t\t\t<Stack\r\n\t\t\t\twidth=\"100%\"\r\n\t\t\t\tdisplay=\"flex\"\r\n\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\tflexWrap=\"wrap\"\r\n\t\t\t\talignItems=\"start\"\r\n\t\t\t\tjustifyContent=\"space-between\"\r\n\t\t\t>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twidth: \"max(200px, 40%)\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{text}\r\n\t\t\t\t</ListItemText>\r\n\t\t\t\t<Stack\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\t\tminWidth=\"max(200px, 25%)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</Stack>\r\n\t\t\t</Stack>\r\n\t\t</ListItem>\r\n\t);\r\n};\r\n\r\ntype IssueDataTableProps = {\r\n\tdisableFilter?: boolean;\r\n\torderBy?: keyof RepoIssueSchema;\r\n\tissues: RepoIssueSchema[];\r\n\ttitle?: string;\r\n\townerType?: string;\r\n\trepoFullNames?: string[];\r\n\tstate?: string;\r\n\trepoOptions?: GenericSelectOptions<string>[];\r\n};\r\nexport const IssueDataTable: React.FC<\r\n\tIssueDataTableProps\r\n> = (props) => {\r\n\tconst {\r\n\t\torderBy,\r\n\t\tdisableFilter,\r\n\t\trepoOptions,\r\n\t\tissues,\r\n\t\ttitle: title_,\r\n\t\trepoFullNames: repoFullNames_,\r\n\t\townerType: ownerType_,\r\n\t\tstate: state_,\r\n\t} = props;\r\n\tconst submit = useSubmit();\r\n\tconst [title, setTitle] = useState(\r\n\t\ttitle_ ?? \"\",\r\n\t);\r\n\tconst repoFullNames = repoFullNames_ ?? [];\r\n\tconst ownerType =\r\n\t\townerType_ ?? getIssueFilterPrefOwnerType();\r\n\tconst state =\r\n\t\tstate_ ?? getIssueFilterPrefState();\r\n\r\n\tconst handleSubmit = (\r\n\t\tkey: string,\r\n\t\tvalue: string,\r\n\t) => {\r\n\t\tsubmit(\r\n\t\t\t{\r\n\t\t\t\ttitle,\r\n\t\t\t\tstate,\r\n\t\t\t\townerType,\r\n\t\t\t\trepoFullNames,\r\n\t\t\t\t[key]: value,\r\n\t\t\t},\r\n\t\t\t{ action: \"./\", method: \"get\" },\r\n\t\t);\r\n\t};\r\n\tconst handleOwnerTypeChange = (\r\n\t\tevent: SelectChangeEvent<string>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\"ownerType\", value);\r\n\t};\r\n\tconst handleStateChange = (\r\n\t\tevent: SelectChangeEvent<string>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\"state\", value);\r\n\t};\r\n\tconst handleRepoFullNamesChange = (\r\n\t\tevent: SelectChangeEvent<string[]>,\r\n\t) => {\r\n\t\tconst value = event.target.value;\r\n\t\thandleSubmit(\r\n\t\t\t\"repoFullNames\",\r\n\t\t\tvalue.toString(),\r\n\t\t);\r\n\t};\r\n\tconst handleRepoFullNamesReset = () => {\r\n\t\thandleSubmit(\"repoFullNames\", \"\");\r\n\t};\r\n\tconst handleTitleSubmit = () => {\r\n\t\thandleSubmit(\"title\", title);\r\n\t};\r\n\r\n\tconst [filterOpen, setFilterOpen] =\r\n\t\tuseState(false);\r\n\tconst toggleFilter = () => {\r\n\t\tsetFilterOpen(!filterOpen);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<Box>\r\n\t\t\t{!disableFilter && (\r\n\t\t\t\t<Fragment>\r\n\t\t\t\t\t<Toolbar\r\n\t\t\t\t\t\tdisableGutters\r\n\t\t\t\t\t\tvariant=\"dense\"\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t\tflexWrap: \"wrap\",\r\n\t\t\t\t\t\t\tgap: 1,\r\n\t\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\t\tjustifyContent: \"space-between\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Stack\r\n\t\t\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\t\t\tdirection=\"row\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<StyledTextField\r\n\t\t\t\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Search issue\"\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tvalue={title}\r\n\t\t\t\t\t\t\t\tonChange={setTitle}\r\n\t\t\t\t\t\t\t\tonEnter={handleTitleSubmit}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\tonClick={toggleFilter}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<FilterListRounded />\r\n\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t</Stack>\r\n\t\t\t\t\t\t<Typography>\r\n\t\t\t\t\t\t\tShowing {issues.length}{\" \"}\r\n\t\t\t\t\t\t\t{issues.length === 1\r\n\t\t\t\t\t\t\t\t? \"issue\"\r\n\t\t\t\t\t\t\t\t: \"issues\"}\r\n\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t</Toolbar>\r\n\t\t\t\t\t<Collapse in={filterOpen}>\r\n\t\t\t\t\t\t<List disablePadding>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"Repositories\">\r\n\t\t\t\t\t\t\t\t<StyledSelectMultiple\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsubheader=\"Repositories\"\r\n\t\t\t\t\t\t\t\t\trenderValue={(value) =>\r\n\t\t\t\t\t\t\t\t\t\t`${value.length} selected`\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={repoFullNames}\r\n\t\t\t\t\t\t\t\t\toptions={repoOptions}\r\n\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\thandleRepoFullNamesChange\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t\t\thandleRepoFullNamesReset\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ClearRounded />\r\n\t\t\t\t\t\t\t\t</IconButton>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"State\">\r\n\t\t\t\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={state}\r\n\t\t\t\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\t\t\t\tISSUE_FILTER_STATE_OPTIONS\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tonChange={handleStateChange}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t\t<WrappableListItem text=\"State\">\r\n\t\t\t\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\t\t\tvalue={ownerType}\r\n\t\t\t\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\t\t\t\tISSUE_FILTER_OWNER_TYPE_OPTIONS\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tonChange={handleOwnerTypeChange}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t\t\t</List>\r\n\t\t\t\t\t</Collapse>\r\n\t\t\t\t</Fragment>\r\n\t\t\t)}\r\n\t\t\t<StyledDataTable\r\n\t\t\t\titems={issues}\r\n\t\t\t\tcolumnDefinition={COLUMN_DEFINITION}\r\n\t\t\t\tdefaultOrderBy={orderBy ?? \"updated_at\"}\r\n\t\t\t\torderingFn={getOrderingFn}\r\n\t\t\t/>\r\n\t\t</Box>\r\n\t);\r\n};\r\n","import {\r\n\tCard,\r\n\tCardHeader,\r\n\tStack,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { useLoaderData } from \"react-router\";\r\nimport { IssueDataTable } from \"~components/IssueDataTable\";\r\nimport { RepoDataTable } from \"~components/RepoDataTable\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nexport const HomePage: FC = () => {\r\n\tconst {\r\n\t\tactiveRepos,\r\n\t\tarchivedRepos,\r\n\t\tclosedIssues,\r\n\t\topenIssues,\r\n\t\trecentRepos,\r\n\t\trecentIssues,\r\n\t} = useLoaderData() as LoaderData;\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath=\"~\"\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: { flexGrow: 1 },\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Stack\r\n\t\t\t\tspacing={2}\r\n\t\t\t\tpadding={4}\r\n\t\t\t>\r\n\t\t\t\t<Stack\r\n\t\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\t\tflexWrap=\"wrap\"\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tgap={1}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\tsx={{ flexGrow: 1, minWidth: 250 }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<CardHeader\r\n\t\t\t\t\t\t\ttitle={activeRepos}\r\n\t\t\t\t\t\t\tsubheader={\r\n\t\t\t\t\t\t\t\tactiveRepos > 1\r\n\t\t\t\t\t\t\t\t\t? \"Active repositories\"\r\n\t\t\t\t\t\t\t\t\t: \"Active repositoriy\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttitleTypographyProps={{\r\n\t\t\t\t\t\t\t\tcolor: \"secondary\",\r\n\t\t\t\t\t\t\t\tfontWeight: \"900\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\tsx={{ flexGrow: 1, minWidth: 250 }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<CardHeader\r\n\t\t\t\t\t\t\ttitle={archivedRepos}\r\n\t\t\t\t\t\t\tsubheader={\r\n\t\t\t\t\t\t\t\tarchivedRepos > 1\r\n\t\t\t\t\t\t\t\t\t? \"Archived repositories\"\r\n\t\t\t\t\t\t\t\t\t: \"Archived repositoriy\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttitleTypographyProps={{\r\n\t\t\t\t\t\t\t\tcolor: \"secondary\",\r\n\t\t\t\t\t\t\t\tfontWeight: \"900\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\tsx={{ flexGrow: 1, minWidth: 250 }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<CardHeader\r\n\t\t\t\t\t\t\ttitle={openIssues}\r\n\t\t\t\t\t\t\tsubheader={\r\n\t\t\t\t\t\t\t\topenIssues > 1\r\n\t\t\t\t\t\t\t\t\t? \"Open issues\"\r\n\t\t\t\t\t\t\t\t\t: \"Open issue\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttitleTypographyProps={{\r\n\t\t\t\t\t\t\t\tcolor: \"secondary\",\r\n\t\t\t\t\t\t\t\tfontWeight: \"900\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t\t<Card\r\n\t\t\t\t\t\tvariant=\"outlined\"\r\n\t\t\t\t\t\tsx={{ flexGrow: 1, minWidth: 250 }}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<CardHeader\r\n\t\t\t\t\t\t\ttitle={closedIssues}\r\n\t\t\t\t\t\t\tsubheader={\r\n\t\t\t\t\t\t\t\tclosedIssues > 1\r\n\t\t\t\t\t\t\t\t\t? \"Closed issues\"\r\n\t\t\t\t\t\t\t\t\t: \"Closed issue\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttitleTypographyProps={{\r\n\t\t\t\t\t\t\t\tcolor: \"secondary\",\r\n\t\t\t\t\t\t\t\tfontWeight: \"900\",\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Card>\r\n\t\t\t\t</Stack>\r\n\t\t\t\t<Typography\r\n\t\t\t\t\tfontSize=\"large\"\r\n\t\t\t\t\tfontWeight=\"bold\"\r\n\t\t\t\t>\r\n\t\t\t\t\tRecent repositories\r\n\t\t\t\t</Typography>\r\n\t\t\t\t<RepoDataTable\r\n\t\t\t\t\trepos={recentRepos}\r\n\t\t\t\t\torderBy=\"pushed_at\"\r\n\t\t\t\t\tdisableFilter\r\n\t\t\t\t/>\r\n\t\t\t\t<Typography\r\n\t\t\t\t\tfontSize=\"large\"\r\n\t\t\t\t\tfontWeight=\"bold\"\r\n\t\t\t\t>\r\n\t\t\t\t\tRecent issues\r\n\t\t\t\t</Typography>\r\n\t\t\t\t<IssueDataTable\r\n\t\t\t\t\tissues={recentIssues}\r\n\t\t\t\t\torderBy=\"updated_at\"\r\n\t\t\t\t\tdisableFilter\r\n\t\t\t\t/>\r\n\t\t\t</Stack>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { LoaderFunction } from \"react-router-dom\";\r\nimport { orderByString } from \"~core/sorting\";\r\nimport {\r\n\tgetCachedIssues,\r\n\tgetCachedRepos,\r\n} from \"~database/cached\";\r\nimport {\r\n\tRepoIssueSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\tactiveRepos: number;\r\n\tarchivedRepos: number;\r\n\topenIssues: number;\r\n\tclosedIssues: number;\r\n\trecentRepos: RepoSchema[];\r\n\trecentIssues: RepoIssueSchema[];\r\n};\r\nexport const loaderHome: LoaderFunction =\r\n\tasync (): Promise<LoaderData> => {\r\n\t\tdocument.title = \"~\";\r\n\r\n\t\tconst repos = await getCachedRepos();\r\n\t\tconst issues = (\r\n\t\t\tawait getCachedIssues()\r\n\t\t).filter(\r\n\t\t\t({ owner_type }) => owner_type === \"User\",\r\n\t\t);\r\n\r\n\t\tconst activeRepos = repos.filter(\r\n\t\t\t({ is_archived }) => !is_archived,\r\n\t\t).length;\r\n\t\tconst archivedRepos =\r\n\t\t\trepos.length - activeRepos;\r\n\r\n\t\tconst openIssues = issues.filter(\r\n\t\t\t({ state }) => state === \"open\",\r\n\t\t).length;\r\n\t\tconst closedIssues =\r\n\t\t\tissues.length - openIssues;\r\n\r\n\t\trepos.sort(\r\n\t\t\t({ pushed_at: a }, { pushed_at: b }) =>\r\n\t\t\t\torderByString(a, b),\r\n\t\t);\r\n\t\tissues.sort(\r\n\t\t\t({ updated_at: a }, { updated_at: b }) =>\r\n\t\t\t\torderByString(a, b),\r\n\t\t);\r\n\t\tconst recentRepos = repos.slice(0, 5);\r\n\t\tconst recentIssues = issues.slice(0, 5);\r\n\r\n\t\tconst loaderData: LoaderData = {\r\n\t\t\tactiveRepos,\r\n\t\t\tarchivedRepos,\r\n\t\t\topenIssues,\r\n\t\t\tclosedIssues,\r\n\t\t\trecentIssues,\r\n\t\t\trecentRepos,\r\n\t\t};\r\n\r\n\t\treturn loaderData;\r\n\t};\r\n","import rehypeDocument from \"rehype-document\";\r\nimport rehypeKatex from \"rehype-katex\";\r\nimport rehypeSanitize from \"rehype-sanitize\";\r\nimport rehypeStringify from \"rehype-stringify\";\r\nimport remarkGfm from \"remark-gfm\";\r\nimport remarkMath from \"remark-math\";\r\nimport remarkParse from \"remark-parse\";\r\nimport remarkRehype from \"remark-rehype\";\r\nimport { unified } from \"unified\";\r\n\r\nexport const parseMarkdown = (\r\n\tcontent: string,\r\n) => {\r\n\treturn unified()\r\n\t\t.use(remarkParse, {\r\n\t\t\tfragment: true,\r\n\t\t})\r\n\t\t.use(remarkGfm)\r\n\t\t.use(remarkMath)\r\n\t\t.use(remarkRehype)\r\n\t\t.use(rehypeSanitize)\r\n\t\t.use(rehypeKatex)\r\n\t\t.use(rehypeDocument, {\r\n\t\t\tcss: \"https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css\",\r\n\t\t})\r\n\t\t.use(rehypeStringify)\r\n\t\t.processSync(content.normalize())\r\n\t\t.toString()\r\n\t\t.replace(\r\n\t\t\t`<table`,\r\n\t\t\t`<div style='display: block; width: 100%; overflow-x: auto'><table`,\r\n\t\t)\r\n\t\t.replace(`</table>`, `</table></div>`);\r\n};\r\n","import {\r\n\tTypography,\r\n\tTypographyProps,\r\n} from \"@mui/material\";\r\nimport { FC, useEffect, useRef } from \"react\";\r\nimport { parseMarkdown } from \"~core/markdown\";\r\n\r\ntype MarkdownProps = Omit<\r\n\tTypographyProps,\r\n\t\"ref\"\r\n> & {\r\n\tmarkdownContent: string | undefined | null;\r\n\temptyText: string | undefined;\r\n};\r\nexport const Markdown: FC<MarkdownProps> = (\r\n\tprops,\r\n) => {\r\n\tconst {\r\n\t\tmarkdownContent: content,\r\n\t\temptyText,\r\n\t\tsx,\r\n\t\t...rest\r\n\t} = props;\r\n\r\n\tconst contentRef =\r\n\t\tuseRef<HTMLDivElement | null>(null);\r\n\r\n\tuseEffect(() => {\r\n\t\tif (\r\n\t\t\tcontent === undefined ||\r\n\t\t\tcontent === null ||\r\n\t\t\tcontentRef === null ||\r\n\t\t\tcontentRef.current === null\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst innerHtml = parseMarkdown(content);\r\n\t\tcontentRef.current.innerHTML = innerHtml;\r\n\t}, [content]);\r\n\r\n\treturn (\r\n\t\t<Typography\r\n\t\t\t{...rest}\r\n\t\t\tref={contentRef}\r\n\t\t\tcomponent=\"div\"\r\n\t\t\tdisplay=\"block\"\r\n\t\t\twidth=\"100%\"\r\n\t\t\tsx={{\r\n\t\t\t\t...sx,\r\n\t\t\t\toverflowX: \"auto\",\r\n\t\t\t\tfontFamily: \"IBM Plex Serif\",\r\n\t\t\t\twordBreak: \"break-word\",\r\n\t\t\t\twordWrap: \"break-word\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{emptyText}\r\n\t\t</Typography>\r\n\t);\r\n};\r\n","import {\r\n\tBox,\r\n\tContainer,\r\n\tList,\r\n\tListItem,\r\n\tListItemText,\r\n\tSxProps,\r\n\tTheme,\r\n\tTypography,\r\n\tcapitalize,\r\n} from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { useLoaderData } from \"react-router\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nimport { ReactNode } from \"react\";\r\nimport { Markdown } from \"~components/Markdown\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport {\r\n\tnormalizeDateString,\r\n\ttoTimeStamp,\r\n} from \"~core/time\";\r\nimport {\r\n\tRepoIssueCommentSchema,\r\n\tRepoIssueSchema,\r\n} from \"~types/schemas\";\r\n\r\nconst METADATA_DEFINITIONS: {\r\n\tflexGrow: number;\r\n\tlabel: string;\r\n\trender: (repo: RepoIssueSchema) => ReactNode;\r\n}[] = [\r\n\t{\r\n\t\tlabel: \"Last updated\",\r\n\t\trender: (issue) =>\r\n\t\t\ttoTimeStamp(issue.updated_at, \"Never\"),\r\n\t\tflexGrow: 1,\r\n\t},\r\n\t{\r\n\t\tlabel: \"Created\",\r\n\t\trender: (issue) =>\r\n\t\t\ttoTimeStamp(issue.created_at, \"Unknown\"),\r\n\t\tflexGrow: 1,\r\n\t},\r\n\t{\r\n\t\tlabel: \"Closed\",\r\n\t\trender: (issue) =>\r\n\t\t\ttoTimeStamp(issue.closed_at, \"Not closed\"),\r\n\t\tflexGrow: 1,\r\n\t},\r\n\t{\r\n\t\tlabel: \"State\",\r\n\t\trender: (issue) => capitalize(issue.state),\r\n\t\tflexGrow: 0,\r\n\t},\r\n\t{\r\n\t\tlabel: \"Owner type\",\r\n\t\trender: (issue) =>\r\n\t\t\tissue.owner_type ?? \"Unknown\",\r\n\t\tflexGrow: 0,\r\n\t},\r\n];\r\n\r\ntype IssueMetaDataListProps = {\r\n\tissue: RepoIssueSchema;\r\n};\r\nconst IssueMetaData: FC<\r\n\tIssueMetaDataListProps\r\n> = (props) => {\r\n\tconst { issue } = props;\r\n\treturn (\r\n\t\t<List\r\n\t\t\tdense\r\n\t\t\tdisablePadding\r\n\t\t\tsx={{\r\n\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\tflexWrap: \"wrap\",\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{METADATA_DEFINITIONS.map(\r\n\t\t\t\t({ label, render, flexGrow }) => (\r\n\t\t\t\t\t<ListItem\r\n\t\t\t\t\t\tdisableGutters\r\n\t\t\t\t\t\tdisablePadding\r\n\t\t\t\t\t\tkey={label}\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\tflexGrow,\r\n\t\t\t\t\t\t\twidth: 240,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\tprimary={render(issue)}\r\n\t\t\t\t\t\t\tsecondary={label}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</ListItem>\r\n\t\t\t\t),\r\n\t\t\t)}\r\n\t\t</List>\r\n\t);\r\n};\r\n\r\ntype IssueCommentProps = {\r\n\tcomment: RepoIssueCommentSchema;\r\n\tindex: number;\r\n};\r\nconst IssueComment: FC<IssueCommentProps> = (\r\n\tprops,\r\n) => {\r\n\tconst { index, comment } = props;\r\n\treturn (\r\n\t\t<Box>\r\n\t\t\t<Typography\r\n\t\t\t\tfontWeight=\"bold\"\r\n\t\t\t\tcomponent=\"a\"\r\n\t\t\t\thref={comment.html_url}\r\n\t\t\t\tsx={{\r\n\t\t\t\t\ttextDecoration: \"none\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\tComment #{index}\r\n\t\t\t</Typography>\r\n\t\t\t<List\r\n\t\t\t\tdense\r\n\t\t\t\tsx={{\r\n\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tprimary={normalizeDateString(\r\n\t\t\t\t\t\tcomment.created_at,\r\n\t\t\t\t\t)}\r\n\t\t\t\t\tsecondary=\"Created\"\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tflexGrow: 1,\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tprimary={normalizeDateString(\r\n\t\t\t\t\t\tcomment.updated_at,\r\n\t\t\t\t\t)}\r\n\t\t\t\t\tsecondary=\"Last updated\"\r\n\t\t\t\t/>\r\n\t\t\t</List>\r\n\t\t\t<Markdown\r\n\t\t\t\tmarkdownContent={\r\n\t\t\t\t\tcomment.body ?? undefined\r\n\t\t\t\t}\r\n\t\t\t\temptyText=\"This comment does not have a body or its body not is cached.\"\r\n\t\t\t/>\r\n\t\t</Box>\r\n\t);\r\n};\r\n\r\nexport const IssueDetailsPage: FC = () => {\r\n\tconst { issue, comments } =\r\n\t\tuseLoaderData() as LoaderData;\r\n\r\n\tconst path = `~/repositories/${issue.repo_full_name}/issues/${issue.issue_number}`;\r\n\tconst breadcrumbsProps: SxProps<Theme> = {\r\n\t\tsx: {\r\n\t\t\toverflow: \"auto\",\r\n\t\t\tflexGrow: { xs: 0, sm: 1 },\r\n\t\t},\r\n\t};\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath={path}\r\n\t\t\t\t\tbreadcrumbsProps={breadcrumbsProps}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Container\r\n\t\t\t\tmaxWidth=\"sm\"\r\n\t\t\t\tsx={{\r\n\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\tpaddingY: 4,\r\n\t\t\t\t\tgap: 2,\r\n\t\t\t\t\tflexDirection: \"column\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Box>\r\n\t\t\t\t\t<Typography\r\n\t\t\t\t\t\tfontWeight=\"bold\"\r\n\t\t\t\t\t\tfontSize=\"x-large\"\r\n\t\t\t\t\t\tcomponent=\"a\"\r\n\t\t\t\t\t\thref={issue.html_url}\r\n\t\t\t\t\t\tsx={{\r\n\t\t\t\t\t\t\ttextDecoration: \"none\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{issue.title}\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<IssueMetaData issue={issue} />\r\n\t\t\t\t\t<Markdown\r\n\t\t\t\t\t\tmarkdownContent={\r\n\t\t\t\t\t\t\tissue.body ?? undefined\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\temptyText=\"This issue does not have a body or its body is not cached.\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Box>\r\n\t\t\t\t{comments.map((comment, index) => (\r\n\t\t\t\t\t<IssueComment\r\n\t\t\t\t\t\tkey={`comment-${comment.id}`}\r\n\t\t\t\t\t\tindex={index + 1}\r\n\t\t\t\t\t\tcomment={comment}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))}\r\n\t\t\t</Container>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { LoaderFunction } from \"react-router\";\r\nimport {\r\n\tgetCachedIssueComments,\r\n\tgetCachedRepoIssue,\r\n} from \"~database/cached\";\r\nimport {\r\n\tRepoIssueCommentSchema,\r\n\tRepoIssueSchema,\r\n} from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\tissue: RepoIssueSchema;\r\n\tcomments: RepoIssueCommentSchema[];\r\n};\r\nexport const loader: LoaderFunction = async ({\r\n\tparams,\r\n}) => {\r\n\tconst owner = params.owner;\r\n\tconst repoName = params.repo;\r\n\tconst issueNumber = params.issueNumber;\r\n\tif (\r\n\t\towner === undefined ||\r\n\t\trepoName === undefined ||\r\n\t\tissueNumber === undefined\r\n\t) {\r\n\t\tthrow new Response(\"\", {\r\n\t\t\tstatus: 400,\r\n\t\t\tstatusText: \"Bad requeset\",\r\n\t\t});\r\n\t}\r\n\tif (\r\n\t\t!Number.isSafeInteger(\r\n\t\t\tNumber.parseInt(issueNumber),\r\n\t\t)\r\n\t) {\r\n\t\tthrow new Response(\"\", {\r\n\t\t\tstatus: 400,\r\n\t\t\tstatusText: \"Bad requeset\",\r\n\t\t});\r\n\t}\r\n\r\n\tconst fullName = `${owner}/${repoName}`;\r\n\tconst issue = await getCachedRepoIssue(\r\n\t\tfullName,\r\n\t\tNumber.parseInt(issueNumber),\r\n\t);\r\n\tif (issue === undefined) {\r\n\t\tthrow new Response(\"Not found\", {\r\n\t\t\tstatus: 404,\r\n\t\t\tstatusText:\r\n\t\t\t\t\"Issue does not exist or it is not cached.\",\r\n\t\t});\r\n\t}\r\n\tdocument.title = issue.title;\r\n\tconst loaderData: LoaderData = {\r\n\t\tissue,\r\n\t\tcomments: await getCachedIssueComments(\r\n\t\t\tissue.id,\r\n\t\t),\r\n\t};\r\n\r\n\treturn loaderData;\r\n};\r\n","import { Box } from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { useLoaderData } from \"react-router-dom\";\r\nimport { IssueDataTable } from \"~components/IssueDataTable\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nexport const IssueListPage: FC = () => {\r\n\tconst {\r\n\t\tissues,\r\n\t\trepoOptions,\r\n\t\ttitle,\r\n\t\townerType,\r\n\t\trepoFullNames,\r\n\t\tstate,\r\n\t} = useLoaderData() as LoaderData;\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath=\"~/issues\"\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: { flexGrow: 1 },\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Box\r\n\t\t\t\tpaddingTop={2}\r\n\t\t\t\tpaddingX={2}\r\n\t\t\t>\r\n\t\t\t\t<IssueDataTable\r\n\t\t\t\t\tissues={issues}\r\n\t\t\t\t\trepoOptions={repoOptions}\r\n\t\t\t\t\ttitle={title}\r\n\t\t\t\t\townerType={ownerType}\r\n\t\t\t\t\trepoFullNames={repoFullNames}\r\n\t\t\t\t\tstate={state}\r\n\t\t\t\t/>\r\n\t\t\t</Box>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { matchSorter } from \"match-sorter\";\r\nimport {\r\n\tRepoIssueSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\n\r\nexport const filterRepos = (\r\n\trepos: RepoSchema[],\r\n\tname: string,\r\n\ttopics: string[],\r\n\tvisibility: string,\r\n\tstatus: string,\r\n\ttopicFilterMode: string,\r\n) => {\r\n\tlet items = [...repos];\r\n\r\n\tif (visibility === \"Private\") {\r\n\t\titems = items.filter(\r\n\t\t\t(item) => item.is_private,\r\n\t\t);\r\n\t}\r\n\tif (visibility === \"Public\") {\r\n\t\titems = items.filter(\r\n\t\t\t(item) => !item.is_private,\r\n\t\t);\r\n\t}\r\n\r\n\tif (status === \"Archived\") {\r\n\t\titems = items.filter(\r\n\t\t\t(item) => item.is_archived,\r\n\t\t);\r\n\t}\r\n\tif (status === \"Active\") {\r\n\t\titems = items.filter(\r\n\t\t\t(item) => !item.is_archived,\r\n\t\t);\r\n\t}\r\n\r\n\tif (\r\n\t\ttopics.length > 0 &&\r\n\t\ttopicFilterMode === \"Match all\"\r\n\t) {\r\n\t\titems = items.filter((item) =>\r\n\t\t\ttopics.every((topic) => {\r\n\t\t\t\tif (item.topics === undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn item.topics.includes(topic);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\tif (\r\n\t\ttopics.length > 0 &&\r\n\t\ttopicFilterMode === \"Match any\"\r\n\t) {\r\n\t\titems = items.filter((item) =>\r\n\t\t\ttopics.some((topic) => {\r\n\t\t\t\tif (item.topics === undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn item.topics.includes(topic);\r\n\t\t\t}),\r\n\t\t);\r\n\t}\r\n\r\n\titems = matchSorter(items, name, {\r\n\t\tkeys: [\"full_name\"],\r\n\t});\r\n\treturn items;\r\n};\r\n\r\nexport const filterIssues = (\r\n\tissues: RepoIssueSchema[],\r\n\ttitle: string,\r\n\townerType: string,\r\n\trepoFullNames: string[],\r\n\tstate: string,\r\n) => {\r\n\tlet items = [...issues];\r\n\r\n\tif (ownerType !== \"All\") {\r\n\t\titems = items.filter(\r\n\t\t\t(item) => item.owner_type === ownerType,\r\n\t\t);\r\n\t}\r\n\tif (repoFullNames.length > 0) {\r\n\t\titems = items.filter((item) =>\r\n\t\t\trepoFullNames.includes(item.repo_full_name),\r\n\t\t);\r\n\t}\r\n\tif (state !== \"All\") {\r\n\t\titems = items.filter(\r\n\t\t\t(item) => item.state === state,\r\n\t\t);\r\n\t}\r\n\r\n\titems = matchSorter(items, title, {\r\n\t\tkeys: [\"title\"],\r\n\t});\r\n\treturn items;\r\n};\r\n","import { LoaderFunction } from \"react-router-dom\";\r\nimport { filterIssues } from \"~core/filtering\";\r\nimport { getCachedIssues } from \"~database/index\";\r\nimport {\r\n\tgetIssueFilterPrefOwnerType,\r\n\tgetIssueFilterPrefState,\r\n} from \"~database/preferences\";\r\nimport { GenericSelectOptions } from \"~types/generics\";\r\nimport { RepoIssueSchema } from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\tissues: RepoIssueSchema[];\r\n\trepoOptions: GenericSelectOptions<string>[];\r\n\ttitle: string;\r\n\townerType: string;\r\n\trepoFullNames: string[];\r\n\tstate: string;\r\n};\r\nexport const loader: LoaderFunction = async ({\r\n\trequest,\r\n}): Promise<LoaderData> => {\r\n\tdocument.title = \"issues\";\r\n\tlet issues = await getCachedIssues();\r\n\r\n\tconst uniqueRepoOptions = new Set(\r\n\t\tissues\r\n\t\t\t.map(({ repo_full_name }) => repo_full_name)\r\n\t\t\t.filter((value) => value.length > 0),\r\n\t);\r\n\tconst options = [...uniqueRepoOptions];\r\n\toptions.sort();\r\n\tconst repoOptions: GenericSelectOptions<string>[] =\r\n\t\toptions.map((value) => ({\r\n\t\t\tlabel: value,\r\n\t\t\tvalue,\r\n\t\t}));\r\n\r\n\tconst searchParams = new URL(request.url)\r\n\t\t.searchParams;\r\n\r\n\tconst repoFullNamesParam = searchParams.get(\r\n\t\t\"repoFullNames\",\r\n\t);\r\n\tlet repoFullNames: string[] = [];\r\n\tif (repoFullNamesParam !== null) {\r\n\t\trepoFullNames = repoFullNamesParam\r\n\t\t\t.normalize()\r\n\t\t\t.trim()\r\n\t\t\t.split(\",\")\r\n\t\t\t.map((item) => item.trim())\r\n\t\t\t.filter((item) => item.length > 0);\r\n\t}\r\n\r\n\tconst title = searchParams.get(\"title\") || \"\";\r\n\r\n\tconst ownerType =\r\n\t\tsearchParams.get(\"ownerType\") ||\r\n\t\tgetIssueFilterPrefOwnerType();\r\n\tconst state =\r\n\t\tsearchParams.get(\"state\") ||\r\n\t\tgetIssueFilterPrefState();\r\n\r\n\tissues = filterIssues(\r\n\t\tissues,\r\n\t\ttitle,\r\n\t\townerType,\r\n\t\trepoFullNames,\r\n\t\tstate,\r\n\t);\r\n\r\n\treturn {\r\n\t\tissues,\r\n\t\trepoOptions,\r\n\t\ttitle,\r\n\t\townerType,\r\n\t\trepoFullNames,\r\n\t\tstate,\r\n\t};\r\n};\r\n","import {\r\n\tURLSearchParamsInit,\r\n\tcreateSearchParams,\r\n} from \"react-router-dom\";\r\nimport { SortRule } from \"~types/generics\";\r\n\r\nexport const sortItems = <T>(\r\n\trule: string | null,\r\n\tsortRules: SortRule<T>[],\r\n\titems: T[],\r\n) => {\r\n\tif (sortRules.length <= 0) {\r\n\t\treturn;\r\n\t}\r\n\tlet compareFn = sortRules[0].compareFn;\r\n\tif (!rule) {\r\n\t\tfor (const sortRule of sortRules) {\r\n\t\t\tif (sortRule.value === rule) {\r\n\t\t\t\tcompareFn = sortRule.compareFn;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\titems.sort(compareFn);\r\n};\r\n\r\nexport const extractFilterTags = (\r\n\tqueryString: string | null,\r\n): string[] => {\r\n\tlet filterTags: string[] = [];\r\n\tif (queryString) {\r\n\t\tfilterTags = queryString\r\n\t\t\t.normalize()\r\n\t\t\t.split(\",\");\r\n\t}\r\n\treturn filterTags;\r\n};\r\n\r\nexport const toSearchParam = (\r\n\tquery: URLSearchParamsInit,\r\n) => {\r\n\treturn createSearchParams(query).toString();\r\n};\r\n","import {\r\n\tChevronLeftRounded,\r\n\tClearRounded,\r\n} from \"@mui/icons-material\";\r\nimport {\r\n\tBox,\r\n\tContainer,\r\n\tDivider,\r\n\tDrawer,\r\n\tIconButton,\r\n\tList,\r\n\tListItem,\r\n\tListItemText,\r\n\tStack,\r\n\tTab,\r\n\tTabs,\r\n\tToolbar,\r\n\tTypography,\r\n} from \"@mui/material\";\r\nimport { Buffer } from \"buffer\";\r\nimport { FC, ReactNode, useState } from \"react\";\r\nimport { useLoaderData } from \"react-router\";\r\nimport {\r\n\tLink,\r\n\tuseSubmit,\r\n} from \"react-router-dom\";\r\nimport { IssueDataTable } from \"~components/IssueDataTable\";\r\nimport { Markdown } from \"~components/Markdown\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { toSearchParam } from \"~core/query\";\r\nimport { toTimeStamp } from \"~core/time\";\r\nimport { RepoSchema } from \"~types/schemas\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nconst REPO_METADATA_DEFINITIONS: {\r\n\tlabel: string;\r\n\trender: (repo: RepoSchema) => ReactNode;\r\n}[] = [\r\n\t{\r\n\t\tlabel: \"Description\",\r\n\t\trender: (repo) =>\r\n\t\t\trepo.description ?? \"No description\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Last pushed\",\r\n\t\trender: (repo) =>\r\n\t\t\ttoTimeStamp(repo.pushed_at, \"Never\"),\r\n\t},\r\n\t{\r\n\t\tlabel: \"Last updated\",\r\n\t\trender: (repo) =>\r\n\t\t\ttoTimeStamp(repo.updated_at, \"Never\"),\r\n\t},\r\n\t{\r\n\t\tlabel: \"Created\",\r\n\t\trender: (repo) =>\r\n\t\t\ttoTimeStamp(repo.created_at, \"Unknown\"),\r\n\t},\r\n\t{\r\n\t\tlabel: \"Visibility\",\r\n\t\trender: (repo) =>\r\n\t\t\trepo.is_private ? \"Private\" : \"Public\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Status\",\r\n\t\trender: (repo) =>\r\n\t\t\trepo.is_private ? \"Archived\" : \"Active\",\r\n\t},\r\n\t{\r\n\t\tlabel: \"Links\",\r\n\t\trender: (repo) => (\r\n\t\t\t<Stack\r\n\t\t\t\tcomponent=\"span\"\r\n\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\tflexWrap=\"wrap\"\r\n\t\t\t\tgap={1}\r\n\t\t\t>\r\n\t\t\t\t<Typography\r\n\t\t\t\t\tcomponent=\"a\"\r\n\t\t\t\t\thref={repo.html_url}\r\n\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t>\r\n\t\t\t\t\tGitHub repository\r\n\t\t\t\t</Typography>\r\n\t\t\t\t<Typography\r\n\t\t\t\t\tcomponent=\"a\"\r\n\t\t\t\t\thref={repo.homepage ?? undefined}\r\n\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t>\r\n\t\t\t\t\tHomepage\r\n\t\t\t\t</Typography>\r\n\t\t\t</Stack>\r\n\t\t),\r\n\t},\r\n\t{\r\n\t\tlabel: \"Topics\",\r\n\t\trender: (repo) =>\r\n\t\t\trepo.topics && repo.topics.length > 0 ? (\r\n\t\t\t\t<Stack\r\n\t\t\t\t\tcomponent=\"span\"\r\n\t\t\t\t\tgap={1}\r\n\t\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\t\tflexWrap=\"wrap\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{repo.topics.map((topic) => (\r\n\t\t\t\t\t\t<Typography\r\n\t\t\t\t\t\t\tkey={topic}\r\n\t\t\t\t\t\t\tcomponent={Link}\r\n\t\t\t\t\t\t\tto={{\r\n\t\t\t\t\t\t\t\tpathname: \"/repositories\",\r\n\t\t\t\t\t\t\t\tsearch: toSearchParam({\r\n\t\t\t\t\t\t\t\t\ttopics: topic,\r\n\t\t\t\t\t\t\t\t}),\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{topic}\r\n\t\t\t\t\t\t</Typography>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</Stack>\r\n\t\t\t) : (\r\n\t\t\t\t\"No topic assigned\"\r\n\t\t\t),\r\n\t},\r\n];\r\n\r\ntype RepoDetailsPageProps = { tab: number };\r\nexport const RepoDetailsPage: FC<\r\n\tRepoDetailsPageProps\r\n> = (props) => {\r\n\tconst { tab } = props;\r\n\tconst {\r\n\t\trepoOptions,\r\n\t\trepo,\r\n\t\tissues,\r\n\t\ttitle,\r\n\t\townerType,\r\n\t\trepoFullNames,\r\n\t\tstate,\r\n\t} = useLoaderData() as LoaderData;\r\n\r\n\tconst submit = useSubmit();\r\n\tconst handleTabChange = (\r\n\t\t_: React.SyntheticEvent<Element, Event>,\r\n\t\tvalue: number,\r\n\t) => {\r\n\t\tlet path = `/repositories/${repo.full_name}`;\r\n\t\tif (value === 1) {\r\n\t\t\tpath = `${path}/issues`;\r\n\t\t}\r\n\t\tsubmit({}, { action: path, method: \"get\" });\r\n\t};\r\n\r\n\tconst [drawerOpen, setDrawerOpen] =\r\n\t\tuseState(false);\r\n\tconst toggleDrawer = () => {\r\n\t\tsetDrawerOpen(!drawerOpen);\r\n\t};\r\n\tconst closeDrawer = () => {\r\n\t\tsetDrawerOpen(false);\r\n\t};\r\n\r\n\tlet decodedReadme: string | undefined;\r\n\tif (repo.readme !== undefined) {\r\n\t\tdecodedReadme = Buffer.from(\r\n\t\t\trepo.readme,\r\n\t\t\t\"base64\",\r\n\t\t).toString();\r\n\t}\r\n\r\n\tlet path = `~/repositories/${repo.full_name}`;\r\n\tif (tab === 1) {\r\n\t\tpath = `${path}/issues`;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath={path}\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: {\r\n\t\t\t\t\t\t\toverflow: \"auto\",\r\n\t\t\t\t\t\t\tflexGrow: { xs: 0, sm: 1 },\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t\tseconadaryAction={\r\n\t\t\t\t<IconButton\r\n\t\t\t\t\tdisableRipple\r\n\t\t\t\t\tonClick={toggleDrawer}\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tflexGrow: 0,\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronLeftRounded />\r\n\t\t\t\t</IconButton>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Toolbar\r\n\t\t\t\tdisableGutters\r\n\t\t\t\tvariant=\"dense\"\r\n\t\t\t>\r\n\t\t\t\t<Tabs\r\n\t\t\t\t\tvalue={tab}\r\n\t\t\t\t\tonChange={handleTabChange}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tab\r\n\t\t\t\t\t\tvalue={0}\r\n\t\t\t\t\t\tlabel=\"Readme\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Tab\r\n\t\t\t\t\t\tvalue={1}\r\n\t\t\t\t\t\tlabel=\"Issues\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Tabs>\r\n\t\t\t</Toolbar>\r\n\t\t\t<Divider />\r\n\t\t\t{tab !== 1 ? (\r\n\t\t\t\t<Container\r\n\t\t\t\t\tmaxWidth=\"sm\"\r\n\t\t\t\t\tsx={{ paddingY: 4 }}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Markdown\r\n\t\t\t\t\t\temptyText=\"This repository does not contain a readme.\"\r\n\t\t\t\t\t\tmarkdownContent={decodedReadme}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Container>\r\n\t\t\t) : (\r\n\t\t\t\t<Box padding={2}>\r\n\t\t\t\t\t<IssueDataTable\r\n\t\t\t\t\t\trepoOptions={repoOptions}\r\n\t\t\t\t\t\tissues={issues}\r\n\t\t\t\t\t\ttitle={title}\r\n\t\t\t\t\t\townerType={ownerType}\r\n\t\t\t\t\t\trepoFullNames={repoFullNames}\r\n\t\t\t\t\t\tstate={state}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Box>\r\n\t\t\t)}\r\n\t\t\t<Drawer\r\n\t\t\t\televation={0}\r\n\t\t\t\tanchor=\"right\"\r\n\t\t\t\topen={drawerOpen}\r\n\t\t\t\tonClose={closeDrawer}\r\n\t\t\t\tPaperProps={{\r\n\t\t\t\t\tsx: { width: 240 },\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Toolbar\r\n\t\t\t\t\tvariant=\"dense\"\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\tdisplay: \"flex\",\r\n\t\t\t\t\t\tflexDirection: \"row\",\r\n\t\t\t\t\t\talignItems: \"center\",\r\n\t\t\t\t\t\tjustifyContent: \"space-between\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Typography fontWeight=\"bold\">\r\n\t\t\t\t\t\tMetadata\r\n\t\t\t\t\t</Typography>\r\n\t\t\t\t\t<IconButton\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tonClick={closeDrawer}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ClearRounded />\r\n\t\t\t\t\t</IconButton>\r\n\t\t\t\t</Toolbar>\r\n\t\t\t\t<Divider\r\n\t\t\t\t\tflexItem\r\n\t\t\t\t\tvariant=\"fullWidth\"\r\n\t\t\t\t/>\r\n\t\t\t\t<List\r\n\t\t\t\t\tdisablePadding\r\n\t\t\t\t\tdense\r\n\t\t\t\t>\r\n\t\t\t\t\t{REPO_METADATA_DEFINITIONS.map(\r\n\t\t\t\t\t\t({ label, render }) => (\r\n\t\t\t\t\t\t\t<ListItem key={label}>\r\n\t\t\t\t\t\t\t\t<ListItemText\r\n\t\t\t\t\t\t\t\t\tsecondary={render(repo)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t</ListItemText>\r\n\t\t\t\t\t\t\t</ListItem>\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t)}\r\n\t\t\t\t</List>\r\n\t\t\t</Drawer>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { LoaderFunction } from \"react-router\";\r\nimport { filterIssues } from \"~core/filtering\";\r\nimport {\r\n\tgetCachedRepo,\r\n\tgetCachedRepoIssues,\r\n} from \"~database/cached\";\r\nimport {\r\n\tgetIssueFilterPrefOwnerType,\r\n\tgetIssueFilterPrefState,\r\n} from \"~database/preferences\";\r\nimport { GenericSelectOptions } from \"~types/generics\";\r\nimport {\r\n\tRepoIssueSchema,\r\n\tRepoSchema,\r\n} from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\trepo: RepoSchema;\r\n\tissues: RepoIssueSchema[];\r\n\ttitle: string;\r\n\townerType: string;\r\n\trepoFullNames: string[];\r\n\trepoOptions: GenericSelectOptions<string>[];\r\n\tstate: string;\r\n};\r\nexport const loader: LoaderFunction = async ({\r\n\tparams,\r\n\trequest,\r\n}) => {\r\n\tconst owner = params.owner;\r\n\tconst repoName = params.repo;\r\n\tif (\r\n\t\towner === undefined ||\r\n\t\trepoName === undefined\r\n\t) {\r\n\t\tthrow new Response(\"\", {\r\n\t\t\tstatus: 400,\r\n\t\t\tstatusText: \"Bad requeset\",\r\n\t\t});\r\n\t}\r\n\r\n\tconst fullName = `${owner}/${repoName}`;\r\n\tlet repo = await getCachedRepo(fullName);\r\n\tif (repo === undefined) {\r\n\t\tthrow new Response(\"Not found\", {\r\n\t\t\tstatus: 404,\r\n\t\t\tstatusText: \"Repository not found in cache\",\r\n\t\t});\r\n\t}\r\n\tdocument.title = repo.name;\r\n\r\n\tconst searchParams = new URL(request.url)\r\n\t\t.searchParams;\r\n\tconst title = searchParams.get(\"title\") || \"\";\r\n\tconst ownerType =\r\n\t\tsearchParams.get(\"ownerType\") ||\r\n\t\tgetIssueFilterPrefOwnerType();\r\n\tconst state =\r\n\t\tsearchParams.get(\"state\") ||\r\n\t\tgetIssueFilterPrefState();\r\n\r\n\tlet issues = await getCachedRepoIssues(\r\n\t\trepo.full_name,\r\n\t);\r\n\tconst repoFullNames: string[] = [\r\n\t\trepo.full_name,\r\n\t];\r\n\tissues = filterIssues(\r\n\t\tissues,\r\n\t\ttitle,\r\n\t\townerType,\r\n\t\trepoFullNames,\r\n\t\tstate,\r\n\t);\r\n\r\n\tconst repoOptions: GenericSelectOptions<string>[] =\r\n\t\t[\r\n\t\t\t{\r\n\t\t\t\tlabel: repo.full_name,\r\n\t\t\t\tvalue: repo.full_name,\r\n\t\t\t},\r\n\t\t];\r\n\tconst loaderData: LoaderData = {\r\n\t\trepo,\r\n\t\tissues,\r\n\t\ttitle,\r\n\t\townerType,\r\n\t\trepoFullNames,\r\n\t\tstate,\r\n\t\trepoOptions,\r\n\t};\r\n\r\n\treturn loaderData;\r\n};\r\n","import { Box } from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { useLoaderData } from \"react-router-dom\";\r\nimport { RepoDataTable } from \"~components/RepoDataTable\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { LoaderData } from \"./loader\";\r\n\r\nexport const RepoListPage: FC = () => {\r\n\tconst {\r\n\t\trepos,\r\n\t\ttopicOptions,\r\n\t\ttopics,\r\n\t\tname,\r\n\t\tvisibility,\r\n\t\tstatus,\r\n\t\ttopicMatchStrategy,\r\n\t} = useLoaderData() as LoaderData;\r\n\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath=\"~/repositories\"\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: { flexGrow: 1 },\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Box padding={2}>\r\n\t\t\t\t<RepoDataTable\r\n\t\t\t\t\ttopicOptions={topicOptions}\r\n\t\t\t\t\trepos={repos}\r\n\t\t\t\t\ttopics={topics}\r\n\t\t\t\t\tname={name}\r\n\t\t\t\t\tvisibility={visibility}\r\n\t\t\t\t\tstatus={status}\r\n\t\t\t\t\ttopicMatchStrategy={topicMatchStrategy}\r\n\t\t\t\t/>\r\n\t\t\t</Box>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import { LoaderFunction } from \"react-router-dom\";\r\nimport { filterRepos } from \"~core/filtering\";\r\nimport {\r\n\tgetCachedRepos,\r\n\tgetCachedTopics,\r\n} from \"~database/index\";\r\nimport {\r\n\tgetRepoFilterPrefStatus,\r\n\tgetRepoFilterPrefTopicMatchStrategy,\r\n\tgetRepoFilterPrefVisibility,\r\n} from \"~database/preferences\";\r\nimport { GenericSelectOptions } from \"~types/generics\";\r\nimport { RepoSchema } from \"~types/schemas\";\r\n\r\nexport type LoaderData = {\r\n\trepos: RepoSchema[];\r\n\ttopicOptions: GenericSelectOptions<string>[];\r\n\ttopics: string[];\r\n\tname: string;\r\n\tvisibility: string;\r\n\tstatus: string;\r\n\ttopicMatchStrategy: string;\r\n};\r\nexport const loader: LoaderFunction = async ({\r\n\trequest,\r\n}): Promise<LoaderData> => {\r\n\tdocument.title = \"repositories\";\r\n\tconst topicOptions: GenericSelectOptions<string>[] =\r\n\t\t(await getCachedTopics()).map((topic) => {\r\n\t\t\treturn { label: topic, value: topic };\r\n\t\t});\r\n\tlet repos = await getCachedRepos();\r\n\r\n\tconst searchParams = new URL(request.url)\r\n\t\t.searchParams;\r\n\tconst topicsParam = searchParams.get(\"topics\");\r\n\tlet topics: string[] = [];\r\n\tif (topicsParam !== null) {\r\n\t\ttopics = topicsParam\r\n\t\t\t.normalize()\r\n\t\t\t.trim()\r\n\t\t\t.split(\",\")\r\n\t\t\t.map((topic) => topic.trim())\r\n\t\t\t.filter((topic) => topic.length > 0);\r\n\t}\r\n\r\n\tconst name = searchParams.get(\"name\") || \"\";\r\n\tconst status =\r\n\t\tsearchParams.get(\"status\") ||\r\n\t\tgetRepoFilterPrefStatus();\r\n\tconst visibility =\r\n\t\tsearchParams.get(\"visibility\") ||\r\n\t\tgetRepoFilterPrefVisibility();\r\n\tconst topicMatchStrategy =\r\n\t\tsearchParams.get(\"topicMatchStrategy\") ||\r\n\t\tgetRepoFilterPrefTopicMatchStrategy();\r\n\trepos = filterRepos(\r\n\t\trepos,\r\n\t\tname,\r\n\t\ttopics,\r\n\t\tvisibility,\r\n\t\tstatus,\r\n\t\ttopicMatchStrategy,\r\n\t);\r\n\r\n\treturn {\r\n\t\ttopicOptions,\r\n\t\trepos,\r\n\t\ttopics,\r\n\t\tname,\r\n\t\tvisibility,\r\n\t\tstatus,\r\n\t\ttopicMatchStrategy,\r\n\t};\r\n};\r\n","import {\r\n\tListItem,\r\n\tListItemText,\r\n\tStack,\r\n} from \"@mui/material\";\r\nimport { FC, ReactNode } from \"react\";\r\n\r\ntype WrappableListItemProps = {\r\n\tchildren?: ReactNode;\r\n\tprimary?: string;\r\n\tsecondary?: string;\r\n};\r\nexport const WrappableListItem: FC<\r\n\tWrappableListItemProps\r\n> = (props) => {\r\n\tconst { secondary, primary, children } = props;\r\n\treturn (\r\n\t\t<ListItem disableGutters>\r\n\t\t\t<Stack\r\n\t\t\t\twidth=\"100%\"\r\n\t\t\t\tdisplay=\"flex\"\r\n\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\tflexWrap=\"wrap\"\r\n\t\t\t\talignItems=\"start\"\r\n\t\t\t\tjustifyContent=\"space-between\"\r\n\t\t\t>\r\n\t\t\t\t<ListItemText\r\n\t\t\t\t\tprimary={primary}\r\n\t\t\t\t\tsecondary={secondary}\r\n\t\t\t\t\tsx={{\r\n\t\t\t\t\t\twidth: \"max(200px, 40%)\",\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t\t<Stack\r\n\t\t\t\t\talignItems=\"center\"\r\n\t\t\t\t\tflexDirection=\"row\"\r\n\t\t\t\t\tminWidth=\"max(200px, 25%)\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{children}\r\n\t\t\t\t</Stack>\r\n\t\t\t</Stack>\r\n\t\t</ListItem>\r\n\t);\r\n};\r\n","import {\r\n\tButton,\r\n\tList,\r\n\tListItem,\r\n\tListSubheader,\r\n\tTextField,\r\n} from \"@mui/material\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport { ChangeEvent, FC, useState } from \"react\";\r\nimport { WrappableListItem } from \"./WrappableListItem\";\r\n\r\nexport const SettingRegionAPI: FC = () => {\r\n\tconst { enqueueSnackbar } = useSnackbar();\r\n\r\n\tconst [\r\n\t\tpersonalAccessToken,\r\n\t\tsetPersonalAccessToken,\r\n\t] = useState(\r\n\t\tlocalStorage.getItem(\r\n\t\t\t\"personal-access-token\",\r\n\t\t) ?? \"\",\r\n\t);\r\n\r\n\tconst handlePasswordChange = (\r\n\t\tevent: ChangeEvent<\r\n\t\t\tHTMLInputElement | HTMLTextAreaElement\r\n\t\t>,\r\n\t) => {\r\n\t\tconst value = event.target.value.normalize();\r\n\t\tsetPersonalAccessToken(value);\r\n\t};\r\n\r\n\tconst commitChanges = () => {\r\n\t\tlocalStorage.setItem(\r\n\t\t\t\"personal-access-token\",\r\n\t\t\tpersonalAccessToken,\r\n\t\t);\r\n\t\tenqueueSnackbar({\r\n\t\t\tmessage: \"Updated personal access token\",\r\n\t\t\tvariant: \"info\",\r\n\t\t});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<List\r\n\t\t\tdisablePadding\r\n\t\t\tsubheader={\r\n\t\t\t\t<ListSubheader\r\n\t\t\t\t\tdisableGutters\r\n\t\t\t\t\tdisableSticky\r\n\t\t\t\t>\r\n\t\t\t\t\tAPI\r\n\t\t\t\t</ListSubheader>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<WrappableListItem primary=\"Personal access token (classic)\">\r\n\t\t\t\t<TextField\r\n\t\t\t\t\tfullWidth\r\n\t\t\t\t\tplaceholder=\"ghp_\"\r\n\t\t\t\t\ttype=\"password\"\r\n\t\t\t\t\tvalue={personalAccessToken}\r\n\t\t\t\t\tonChange={handlePasswordChange}\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t/>\r\n\t\t\t</WrappableListItem>\r\n\t\t\t<ListItem disableGutters>\r\n\t\t\t\t<Button\r\n\t\t\t\t\tdisableElevation\r\n\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\tonClick={commitChanges}\r\n\t\t\t\t>\r\n\t\t\t\t\tUpdate\r\n\t\t\t\t</Button>\r\n\t\t\t</ListItem>\r\n\t\t</List>\r\n\t);\r\n};\r\n","import {\r\n\tList,\r\n\tListSubheader,\r\n\tSelectChangeEvent,\r\n} from \"@mui/material\";\r\nimport { FC, useState } from \"react\";\r\nimport { StyledSelect } from \"~components/StyledSelect\";\r\nimport {\r\n\tISSUE_FILTER_OWNER_TYPE_OPTIONS,\r\n\tISSUE_FILTER_STATE_OPTIONS,\r\n} from \"~constants\";\r\nimport {\r\n\tgetIssueFilterPrefOwnerType,\r\n\tgetIssueFilterPrefState,\r\n\tsetIssueFilterPrefOwnerType,\r\n\tsetIssueFilterPrefState,\r\n} from \"~database/preferences\";\r\nimport { WrappableListItem } from \"./WrappableListItem\";\r\n\r\nexport const SettingRegionIssueFilterPref: FC =\r\n\t() => {\r\n\t\tconst [ownerType, setOwnerType] = useState(\r\n\t\t\tgetIssueFilterPrefOwnerType(),\r\n\t\t);\r\n\t\tconst [state, setState] = useState(\r\n\t\t\tgetIssueFilterPrefState(),\r\n\t\t);\r\n\r\n\t\tconst handleOwnerTypeChange = (\r\n\t\t\tevent: SelectChangeEvent<string>,\r\n\t\t) => {\r\n\t\t\tconst value = event.target.value;\r\n\t\t\tsetIssueFilterPrefOwnerType(value);\r\n\t\t\tsetOwnerType(value);\r\n\t\t};\r\n\t\tconst handleStateChange = (\r\n\t\t\tevent: SelectChangeEvent<string>,\r\n\t\t) => {\r\n\t\t\tconst value = event.target.value;\r\n\t\t\tsetIssueFilterPrefState(value);\r\n\t\t\tsetState(value);\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<List\r\n\t\t\t\tdisablePadding\r\n\t\t\t\tsubheader={\r\n\t\t\t\t\t<ListSubheader\r\n\t\t\t\t\t\tdisableGutters\r\n\t\t\t\t\t\tdisableSticky\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tIssue filter preferences\r\n\t\t\t\t\t</ListSubheader>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<WrappableListItem primary=\"Owner type\">\r\n\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tvalue={ownerType}\r\n\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\tISSUE_FILTER_OWNER_TYPE_OPTIONS\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonChange={handleOwnerTypeChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</WrappableListItem>\r\n\t\t\t\t<WrappableListItem primary=\"State\">\r\n\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tvalue={state}\r\n\t\t\t\t\t\toptions={ISSUE_FILTER_STATE_OPTIONS}\r\n\t\t\t\t\t\tonChange={handleStateChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</WrappableListItem>\r\n\t\t\t</List>\r\n\t\t);\r\n\t};\r\n","import {\r\n\tList,\r\n\tListSubheader,\r\n\tSelectChangeEvent,\r\n} from \"@mui/material\";\r\nimport { FC, useState } from \"react\";\r\nimport { StyledSelect } from \"~components/StyledSelect\";\r\nimport {\r\n\tREPO_FILTER_STATUS_OPTIONS,\r\n\tREPO_FILTER_TOPIC_MATCH_STRATEGY_OPTIONS,\r\n\tREPO_FILTER_VISIBILITY_OPTIONS,\r\n} from \"~constants\";\r\nimport {\r\n\tgetRepoFilterPrefStatus,\r\n\tgetRepoFilterPrefTopicMatchStrategy,\r\n\tgetRepoFilterPrefVisibility,\r\n\tsetRepoFilterPrefStatus,\r\n\tsetRepoFilterPrefTopicMatchStrategy,\r\n\tsetRepoFilterPrefVisibility,\r\n} from \"~database/preferences\";\r\nimport { WrappableListItem } from \"./WrappableListItem\";\r\n\r\nexport const SettingRegionRepoFilterPref: FC =\r\n\t() => {\r\n\t\tconst [mode, setMode] = useState(\r\n\t\t\tgetRepoFilterPrefTopicMatchStrategy(),\r\n\t\t);\r\n\t\tconst [visibility, setVisibility] = useState(\r\n\t\t\tgetRepoFilterPrefVisibility(),\r\n\t\t);\r\n\t\tconst [status, setStatus] = useState(\r\n\t\t\tgetRepoFilterPrefStatus(),\r\n\t\t);\r\n\r\n\t\tconst handleTopicMatchStrategyChange = (\r\n\t\t\tevent: SelectChangeEvent<string>,\r\n\t\t) => {\r\n\t\t\tconst value = event.target.value;\r\n\t\t\tsetRepoFilterPrefTopicMatchStrategy(value);\r\n\t\t\tsetMode(value);\r\n\t\t};\r\n\t\tconst handleVisiblityChange = (\r\n\t\t\tevent: SelectChangeEvent<string>,\r\n\t\t) => {\r\n\t\t\tconst value = event.target.value;\r\n\t\t\tsetRepoFilterPrefVisibility(value);\r\n\t\t\tsetVisibility(value);\r\n\t\t};\r\n\t\tconst handleStatusChange = (\r\n\t\t\tevent: SelectChangeEvent<string>,\r\n\t\t) => {\r\n\t\t\tconst value = event.target.value;\r\n\t\t\tsetRepoFilterPrefStatus(value);\r\n\t\t\tsetStatus(value);\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<List\r\n\t\t\t\tdisablePadding\r\n\t\t\t\tsubheader={\r\n\t\t\t\t\t<ListSubheader\r\n\t\t\t\t\t\tdisableGutters\r\n\t\t\t\t\t\tdisableSticky\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tRepository filter preferences\r\n\t\t\t\t\t</ListSubheader>\r\n\t\t\t\t}\r\n\t\t\t>\r\n\t\t\t\t<WrappableListItem primary=\"Match strategy\">\r\n\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tvalue={mode}\r\n\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\tREPO_FILTER_TOPIC_MATCH_STRATEGY_OPTIONS\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\thandleTopicMatchStrategyChange\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</WrappableListItem>\r\n\t\t\t\t<WrappableListItem primary=\"Visibility\">\r\n\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tvalue={visibility}\r\n\t\t\t\t\t\toptions={\r\n\t\t\t\t\t\t\tREPO_FILTER_VISIBILITY_OPTIONS\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonChange={handleVisiblityChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</WrappableListItem>\r\n\t\t\t\t<WrappableListItem primary=\"Status\">\r\n\t\t\t\t\t<StyledSelect\r\n\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\tdisplayEmpty\r\n\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\tvalue={status}\r\n\t\t\t\t\t\toptions={REPO_FILTER_STATUS_OPTIONS}\r\n\t\t\t\t\t\tonChange={handleStatusChange}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</WrappableListItem>\r\n\t\t\t</List>\r\n\t\t);\r\n\t};\r\n","import {\r\n\tButton,\r\n\tCircularProgress,\r\n\tList,\r\n\tListSubheader,\r\n} from \"@mui/material\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport { FC, useState } from \"react\";\r\nimport { normalizeDateString } from \"~core/time\";\r\nimport {\r\n\tsyncCachedRepoIssueComments,\r\n\tsyncCachedRepoIssues,\r\n\tsyncCachedRepos,\r\n} from \"~database/cached\";\r\nimport { WrappableListItem } from \"./WrappableListItem\";\r\n\r\nconst SYNC_DETAILS: {\r\n\tkey: string;\r\n\tsuccessMsg: string;\r\n\tpromise: (\r\n\t\tonFailure: (err: any) => void,\r\n\t) => Promise<boolean[]>;\r\n}[] = [\r\n\t{\r\n\t\tkey: \"last-sync-repos\",\r\n\t\tsuccessMsg: \"repsitories\",\r\n\t\tpromise: (onFailure) =>\r\n\t\t\tsyncCachedRepos(onFailure),\r\n\t},\r\n\t{\r\n\t\tkey: \"last-sync-issues\",\r\n\t\tsuccessMsg: \"issues\",\r\n\t\tpromise: (onFailure) =>\r\n\t\t\tsyncCachedRepoIssues(onFailure),\r\n\t},\r\n\t{\r\n\t\tkey: \"last-sync-comments\",\r\n\t\tsuccessMsg: \"comments\",\r\n\t\tpromise: (onFailure) =>\r\n\t\t\tsyncCachedRepoIssueComments(onFailure),\r\n\t},\r\n];\r\n\r\nconst LAST_SYNC = [\r\n\tnormalizeDateString(\r\n\t\tlocalStorage.getItem(\"last-sync-repos\"),\r\n\t\t\"Never\",\r\n\t),\r\n\tnormalizeDateString(\r\n\t\tlocalStorage.getItem(\"last-sync-issues\"),\r\n\t\t\"Never\",\r\n\t),\r\n\tnormalizeDateString(\r\n\t\tlocalStorage.getItem(\"last-sync-comments\"),\r\n\t\t\"Never\",\r\n\t),\r\n];\r\n\r\nexport const SettingRegionSync: FC = () => {\r\n\tconst { enqueueSnackbar } = useSnackbar();\r\n\r\n\tconst [syncing, setSyncing] = useState([\r\n\t\tfalse,\r\n\t\tfalse,\r\n\t\tfalse,\r\n\t]);\r\n\tconst [lastSyncs, setLastSync] =\r\n\t\tuseState(LAST_SYNC);\r\n\r\n\tconst enqueueError = (err: any) => {\r\n\t\tenqueueSnackbar({\r\n\t\t\tmessage: String(err),\r\n\t\t\tvariant: \"error\",\r\n\t\t});\r\n\t\tthrow err;\r\n\t};\r\n\r\n\tconst handleSync = async (index: number) => {\r\n\t\tsetSyncing((prev) => {\r\n\t\t\tconst next = [...prev];\r\n\t\t\tnext[index] = true;\r\n\t\t\treturn next;\r\n\t\t});\r\n\r\n\t\tconst { promise, successMsg, key } =\r\n\t\t\tSYNC_DETAILS[index];\r\n\t\tconst res = await promise(enqueueError);\r\n\t\tif (res.every((r) => r)) {\r\n\t\t\tenqueueSnackbar({\r\n\t\t\t\tmessage: `Synced ${successMsg}`,\r\n\t\t\t\tvariant: \"success\",\r\n\t\t\t});\r\n\t\t\tconst timestamp = new Date(\r\n\t\t\t\tDate.now(),\r\n\t\t\t).toISOString();\r\n\t\t\tlocalStorage.setItem(key, timestamp);\r\n\t\t\tsetLastSync((prev) => {\r\n\t\t\t\tconst next = [...prev];\r\n\t\t\t\tnext[index] =\r\n\t\t\t\t\tnormalizeDateString(timestamp);\r\n\t\t\t\treturn next;\r\n\t\t\t});\r\n\t\t}\r\n\t\tsetSyncing((prev) => {\r\n\t\t\tconst next = [...prev];\r\n\t\t\tnext[index] = false;\r\n\t\t\treturn next;\r\n\t\t});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<List\r\n\t\t\tdisablePadding\r\n\t\t\tsubheader={\r\n\t\t\t\t<ListSubheader\r\n\t\t\t\t\tdisableGutters\r\n\t\t\t\t\tdisableSticky\r\n\t\t\t\t>\r\n\t\t\t\t\tSynchronization\r\n\t\t\t\t</ListSubheader>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t{SYNC_DETAILS.map(\r\n\t\t\t\t({ successMsg }, index) => (\r\n\t\t\t\t\t<WrappableListItem\r\n\t\t\t\t\t\tkey={`sync-item-${index}`}\r\n\t\t\t\t\t\tprimary={`Sync ${successMsg}`}\r\n\t\t\t\t\t\tsecondary={`Last sync: ${lastSyncs[index]}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tfullWidth\r\n\t\t\t\t\t\t\tdisableElevation\r\n\t\t\t\t\t\t\tdisabled={syncing[index]}\r\n\t\t\t\t\t\t\tsize=\"small\"\r\n\t\t\t\t\t\t\tvariant=\"contained\"\r\n\t\t\t\t\t\t\tonClick={() => handleSync(index)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{syncing[index] ? (\r\n\t\t\t\t\t\t\t\t<CircularProgress\r\n\t\t\t\t\t\t\t\t\tdisableShrink\r\n\t\t\t\t\t\t\t\t\tsize={28}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t`Sync ${successMsg}`\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</WrappableListItem>\r\n\t\t\t\t),\r\n\t\t\t)}\r\n\t\t</List>\r\n\t);\r\n};\r\n","import { Divider, Stack } from \"@mui/material\";\r\nimport { FC } from \"react\";\r\nimport { StyledBreadcrumbs } from \"~components/StyledBreadcrumbs\";\r\nimport { WithAppBar } from \"~views/WithAppBar\";\r\nimport { SettingRegionAPI } from \"./SettingRegions/SettingRegionAPI\";\r\nimport { SettingRegionIssueFilterPref } from \"./SettingRegions/SettingRegionIssueFilterPref\";\r\nimport { SettingRegionRepoFilterPref } from \"./SettingRegions/SettingRegionRepoFilterPref\";\r\nimport { SettingRegionSync } from \"./SettingRegions/SettingRegionSync\";\r\n\r\nexport const SettingsPage: FC = () => {\r\n\treturn (\r\n\t\t<WithAppBar\r\n\t\t\tlocation={\r\n\t\t\t\t<StyledBreadcrumbs\r\n\t\t\t\t\tpath=\"~/settings\"\r\n\t\t\t\t\tbreadcrumbsProps={{\r\n\t\t\t\t\t\tsx: { flexGrow: 1 },\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t<Stack\r\n\t\t\t\tpaddingTop={2}\r\n\t\t\t\tpaddingX={2}\r\n\t\t\t\tspacing={1}\r\n\t\t\t\tdivider={<Divider variant=\"middle\" />}\r\n\t\t\t>\r\n\t\t\t\t<SettingRegionRepoFilterPref />\r\n\t\t\t\t<SettingRegionIssueFilterPref />\r\n\t\t\t\t<SettingRegionAPI />\r\n\t\t\t\t<SettingRegionSync />\r\n\t\t\t</Stack>\r\n\t\t</WithAppBar>\r\n\t);\r\n};\r\n","import {\r\n\talpha,\r\n\tcreateTheme,\r\n} from \"@mui/material\";\r\n\r\nconst themePalette = createTheme({\r\n\tpalette: {\r\n\t\tmode: \"dark\",\r\n\t\tprimary: {\r\n\t\t\tmain: alpha(\"#00D3D0\", 0.7),\r\n\t\t},\r\n\t\tsecondary: {\r\n\t\t\tmain: \"#D68F3E\",\r\n\t\t},\r\n\t\tbackground: {\r\n\t\t\tdefault: \"#1B1D2D\",\r\n\t\t\tpaper: \"#1B1D2D\",\r\n\t\t},\r\n\t\ttext: {\r\n\t\t\tprimary: alpha(\"#fff\", 0.67),\r\n\t\t\tsecondary: alpha(\"#fff\", 0.5),\r\n\t\t},\r\n\t},\r\n});\r\nconst themeComponent = createTheme({\r\n\tcomponents: {\r\n\t\tMuiBreadcrumbs: {\r\n\t\t\tstyleOverrides: {\r\n\t\t\t\tol: {\r\n\t\t\t\t\tflexWrap: \"nowrap\",\r\n\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tMuiCssBaseline: {\r\n\t\t\tstyleOverrides: {\r\n\t\t\t\t\"html\": {\r\n\t\t\t\t\tbackgroundColor:\r\n\t\t\t\t\t\tthemePalette.palette.background,\r\n\t\t\t\t},\r\n\t\t\t\t\"*\": {\r\n\t\t\t\t\tscrollbarWidth: \"thin\",\r\n\t\t\t\t},\r\n\t\t\t\t\"pre\": {\r\n\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\toverflow: \"auto\",\r\n\t\t\t\t},\r\n\t\t\t\t\"table\": {\r\n\t\t\t\t\tminWidth: \"max-content\",\r\n\t\t\t\t\tborderSpacing: \"1rem 0.5rem\",\r\n\t\t\t\t},\r\n\t\t\t\t\"a\": {\r\n\t\t\t\t\t\"transition\": \"color 0.3s ease\",\r\n\t\t\t\t\t\"color\": alpha(\r\n\t\t\t\t\t\tthemePalette.palette.primary.main,\r\n\t\t\t\t\t\t0.78,\r\n\t\t\t\t\t),\r\n\t\t\t\t\t\"&:hover\": {\r\n\t\t\t\t\t\tcolor: alpha(\r\n\t\t\t\t\t\t\tthemePalette.palette.secondary.main,\r\n\t\t\t\t\t\t\t0.78,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n});\r\n\r\nexport const themeComposed = createTheme({\r\n\tpalette: themePalette.palette,\r\n\tcomponents: themeComponent.components,\r\n});\r\n","import {\r\n\tCssBaseline,\r\n\tThemeProvider,\r\n} from \"@mui/material\";\r\nimport { SnackbarProvider } from \"notistack\";\r\nimport {\r\n\tRouterProvider,\r\n\tcreateHashRouter,\r\n\tredirect,\r\n} from \"react-router-dom\";\r\nimport {\r\n\tCollectionDetailsPage,\r\n\tloaderCollectionDetailsPage,\r\n} from \"~pages/CollectionDetailsPage\";\r\nimport {\r\n\tCollectionListPage,\r\n\tloaderCollectionListPage,\r\n} from \"~pages/CollectionListPage\";\r\nimport { ErrorBoundry } from \"~pages/ErrorBoundary\";\r\nimport {\r\n\tHome,\r\n\tloaderHome,\r\n} from \"~pages/HomePage\";\r\nimport {\r\n\tIssueDetailsPage,\r\n\tloaderIssueDetailsPage,\r\n} from \"~pages/IssueDetailsPage\";\r\nimport {\r\n\tIssueListPage,\r\n\tloaderIssueListPage,\r\n} from \"~pages/IssueListPage\";\r\nimport {\r\n\tRepoDetailsPage,\r\n\tloaderRepoDetailsPage,\r\n} from \"~pages/RepoDetailsPage\";\r\nimport {\r\n\tRepoListPage,\r\n\tloaderRepoListPage,\r\n} from \"~pages/RepoListPage\";\r\nimport { SettingsPage } from \"~pages/SettingsPage/SettingsPage\";\r\nimport { themeComposed } from \"./theme\";\r\n\r\nconst router = createHashRouter(\r\n\t[\r\n\t\t{\r\n\t\t\tindex: true,\r\n\t\t\telement: <Home />,\r\n\t\t\tloader: loaderHome,\r\n\t\t\terrorElement: <ErrorBoundry />,\r\n\t\t},\r\n\t\t{\r\n\t\t\tpath: \"/\",\r\n\t\t\terrorElement: <ErrorBoundry />,\r\n\t\t\tchildren: [\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/repositories\",\r\n\t\t\t\t\telement: <RepoListPage />,\r\n\t\t\t\t\tloader: loaderRepoListPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/repositories/:owner\",\r\n\t\t\t\t\telement: null,\r\n\t\t\t\t\tloader: ({ params }) =>\r\n\t\t\t\t\t\tredirect(\r\n\t\t\t\t\t\t\t`/repositories/?name=${params.owner}`,\r\n\t\t\t\t\t\t),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/repositories/:owner/:repo\",\r\n\t\t\t\t\telement: <RepoDetailsPage tab={0} />,\r\n\t\t\t\t\tloader: loaderRepoDetailsPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/repositories/:owner/:repo/issues\",\r\n\t\t\t\t\telement: <RepoDetailsPage tab={1} />,\r\n\t\t\t\t\tloader: loaderRepoDetailsPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/repositories/:owner/:repo/issues/:issueNumber\",\r\n\t\t\t\t\telement: <IssueDetailsPage />,\r\n\t\t\t\t\tloader: loaderIssueDetailsPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/issues\",\r\n\t\t\t\t\telement: <IssueListPage />,\r\n\t\t\t\t\tloader: loaderIssueListPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/collections\",\r\n\t\t\t\t\telement: <CollectionListPage />,\r\n\t\t\t\t\tloader: loaderCollectionListPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/collections/:collectionName\",\r\n\t\t\t\t\telement: <CollectionDetailsPage />,\r\n\t\t\t\t\tloader: loaderCollectionDetailsPage,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tpath: \"/settings\",\r\n\t\t\t\t\telement: <SettingsPage />,\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t],\r\n\t{\r\n\t\tbasename: \"/\",\r\n\t},\r\n);\r\n\r\nexport const App = () => {\r\n\treturn (\r\n\t\t<ThemeProvider theme={themeComposed}>\r\n\t\t\t<CssBaseline />\r\n\t\t\t<SnackbarProvider\r\n\t\t\t\tpreventDuplicate\r\n\t\t\t\tmaxSnack={3}\r\n\t\t\t\tautoHideDuration={1750}\r\n\t\t\t\tanchorOrigin={{\r\n\t\t\t\t\tvertical: \"bottom\",\r\n\t\t\t\t\thorizontal: \"left\",\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<RouterProvider router={router} />\r\n\t\t\t</SnackbarProvider>\r\n\t\t</ThemeProvider>\r\n\t);\r\n};\r\n","import \"@fontsource/ibm-plex-serif/300.css\";\r\nimport \"@fontsource/ibm-plex-serif/400.css\";\r\nimport \"@fontsource/ibm-plex-serif/500.css\";\r\nimport \"@fontsource/ibm-plex-serif/700.css\";\r\nimport \"@fontsource/roboto/300.css\";\r\nimport \"@fontsource/roboto/400.css\";\r\nimport \"@fontsource/roboto/500.css\";\r\nimport \"@fontsource/roboto/700.css\";\r\nimport React from \"react\";\r\nimport ReactDOM from \"react-dom/client\";\r\nimport { App } from \"./App.tsx\";\r\n\r\nReactDOM.createRoot(\r\n\tdocument.getElementById(\"root\")!,\r\n).render(\r\n\t<React.StrictMode>\r\n\t\t<App />\r\n\t</React.StrictMode>,\r\n);\r\n"],"names":["REPO_FILTER_PREF_TOPIC_MATCH_STRATEGY_KEY","REPO_FILTER_PREF_VISIBILITY_KEY","REPO_FILTER_PREF_STATUS_KEY","REPO_FILTER_TOPIC_MATCH_STRATEGY_OPTIONS","REPO_FILTER_VISIBILITY_OPTIONS","REPO_FILTER_STATUS_OPTIONS","orderByString","a","b","a_","b_","orderByBoolean","orderByNumber","timeSince","dateString","fallback","moment","normalizeDateString","toTimeStamp","timeAt","delta","ISSUE_FILTER_PREF_STATE_KEY","ISSUE_FILTER_PREF_OWNER_TYPE_KEY","ISSUE_FILTER_STATE_OPTIONS","ISSUE_FILTER_OWNER_TYPE_OPTIONS","getRepoFilterPrefVisibility","data","setRepoFilterPrefVisibility","value","getRepoFilterPrefStatus","setRepoFilterPrefStatus","getRepoFilterPrefTopicMatchStrategy","setRepoFilterPrefTopicMatchStrategy","getIssueFilterPrefState","setIssueFilterPrefState","getIssueFilterPrefOwnerType","setIssueFilterPrefOwnerType","StyledTableHead","props","order","orderBy","onRequestSort","columnDefinition","createSortHandler","property","_","jsx","TableHead","TableRow","id","label","index","TableCell","TableSortLabel","StyledTableRow","item","render","StyledDataTable","orderingFn","items","setOrder","useState","orderBy_","setOrderBy","handleRequestSort","items_","useMemo","orderFn","orderedItems_","TableContainer","jsxs","Table","TableBody","StyledSelect","options","rest","options_","Select","MenuItem","StyledSelectMultiple","subheader","ListSubheader","StyledTextField","onEnter","onChange","handleKeyUp","e","handleChange","TextField","COLUMN_DEFINITION","repo","Typography","Link","getOrderingFn","WrappableListItem","text","children","ListItem","Stack","ListItemText","RepoDataTable","disableFilter","repos","topicOptions_","name_","topicMatchStrategy_","status_","topics_","visibility_","submit","useSubmit","name","setName","topics","topicMatchStrategy","visibility","status","handleSubmit","key","handleNameSubmit","handleTopicMatchStrategyChange","event","handleStatusChange","handleVisibilityChange","handleTopicsChange","handleTopicsReset","filterOpen","setFilterOpen","toggleFilter","Box","Fragment","Toolbar","IconButton","FilterListRounded","Collapse","List","ClearRounded","StyledBreadcrumbs","path","breadcrumbsProps","typographyProps","paths","_paths","createElement","Breadcrumbs","db1","db","repoStore","db2","dbPromise","openDB","oldVersion","getToken","token","getOctokit","Octokit","getRepos","req","full_name","created_at","updated_at","description","html_url","homepage","pushed_at","is_archived","is_private","getRepoReadMe","err","fullName","ocktokit","owner","getRepoIssues","repoId","issue_number","title","state","locked","closed_at","body","user","getRepoIssueComment","issueNumber","issueId","getCachedRepos","getCachedRepo","getCachedTopics","uniqueTopics","topic","getCachedIssues","getCachedRepoIssues","repoFullName","getCachedRepoIssue","issues","issue","getCachedIssueComments","updateCachedRepos","updateCachedRepoIssues","updateCachedRepoIssueComments","issueComments","comment","syncCachedRepos","onFailure","res","syncCachedRepoIssues","cachedRepos","syncCachedRepoIssueComments","cachedIssues","getCollections","getCollection","addCollection","updateCollection","nav","WithAppBar","location","seconadaryAction","drawerOpen","setDrawerOpen","toggleDrawer","appBarRef","useRef","contentHeight","setContentHeight","useEffect","appBarHeight","redirectPath","AppBar","ListRounded","Divider","Drawer","CloseRounded","ListItemButton","CollectionDetailsPage","collection","collectedRepos","useLoaderData","setCollected","handleItemChange","values","Button","loader","params","nameParam","reposReqs","CollectionListPage","collections","enqueueSnackbar","useSnackbar","usedNames","handleCollectionCreate","ErrorBoundry","statusText","useRouteError","Container","capitalize","IssueDataTable","repoOptions","title_","repoFullNames_","ownerType_","state_","setTitle","repoFullNames","ownerType","handleOwnerTypeChange","handleStateChange","handleRepoFullNamesChange","handleRepoFullNamesReset","handleTitleSubmit","HomePage","activeRepos","archivedRepos","closedIssues","openIssues","recentRepos","recentIssues","Card","CardHeader","loaderHome","owner_type","parseMarkdown","content","unified","remarkParse","remarkGfm","remarkMath","remarkRehype","rehypeSanitize","rehypeKatex","rehypeDocument","rehypeStringify","Markdown","emptyText","sx","contentRef","innerHtml","METADATA_DEFINITIONS","IssueMetaData","flexGrow","IssueComment","IssueDetailsPage","comments","repoName","IssueListPage","filterRepos","topicFilterMode","matchSorter","filterIssues","request","repo_full_name","searchParams","repoFullNamesParam","toSearchParam","query","createSearchParams","REPO_METADATA_DEFINITIONS","RepoDetailsPage","tab","handleTabChange","closeDrawer","decodedReadme","Buffer","ChevronLeftRounded","Tabs","Tab","RepoListPage","topicOptions","topicsParam","secondary","primary","SettingRegionAPI","personalAccessToken","setPersonalAccessToken","handlePasswordChange","commitChanges","SettingRegionIssueFilterPref","setOwnerType","setState","SettingRegionRepoFilterPref","mode","setMode","setVisibility","setStatus","handleVisiblityChange","SYNC_DETAILS","LAST_SYNC","SettingRegionSync","syncing","setSyncing","lastSyncs","setLastSync","enqueueError","handleSync","prev","next","promise","successMsg","r","timestamp","CircularProgress","SettingsPage","themePalette","createTheme","alpha","themeComponent","themeComposed","router","createHashRouter","Home","loaderRepoListPage","redirect","loaderRepoDetailsPage","loaderIssueDetailsPage","loaderIssueListPage","loaderCollectionListPage","loaderCollectionDetailsPage","App","ThemeProvider","CssBaseline","SnackbarProvider","RouterProvider","ReactDOM","React"],"mappings":"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"}